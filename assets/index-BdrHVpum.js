import{r as g,u as Tt,j as r,d as P,t as p,s as B,m as b,a as Kt,T as _,b as W,c as ot,e as st,f as It,D as Nt,g as At,h as Ot,i as Zt,k as kt,l as J,F as L,I as F,L as H,n as Gt,o as xt,B as v,S as yt,p as k,A as K,X as rt,P as te,q as bt,v as h,w as ee,H as Y,x as j,y as $t,z as Ut,M as Rt,C as Mt,E as ft,G as se,J as G,K as lt,N as re,O as ne,Q as ae,R as oe,U as ie,V as ce,W as ue,Y as le,Z as de,_ as he,$ as me,a0 as pe,a1 as ge,a2 as V,a3 as xe,a4 as fe,a5 as vt,a6 as we,a7 as ye,a8 as Bt,a9 as Z,aa as Pe,ab as tt,ac as Ce,ad as je,ae as be,af as ve,ag as Ee,ah as Le,ai as Se,aj as Te,ak as Ie,al as Ne,am as Ae,an as Oe,ao as ke,ap as Ge,aq as $e,ar as Ue,as as Re,at as Me,au as et,av as it,aw as Be,ax as De,ay as Ve,az as He,aA as Fe}from"./vendor-C9L1vlTP.js";function dt(o){return`/${o.filter(e=>e).map(e=>e.toString().replace(/^\/+/,"")).join("/")}`}const Dt=g.createContext({});function U(){return g.useContext(Dt)}function ze({children:o}){const[t,e]=g.useState(()=>({Paths:location.pathname.split("/").filter(u=>u),Search:new URLSearchParams(location.search),Put:s,Nav:(...u)=>a(dt(u)),Rep:(...u)=>i(dt(u)),Reload:(...u)=>c(u)}));function s(u){history.replaceState(null,"",`${location.pathname}${u.size?"?":""}${u.toString()}`),t.Search=new URLSearchParams(u),e({...t})}function n(u){t.Paths=u.split("/").filter(l=>l),t.Search=new URLSearchParams(location.search),e({...t})}function a(u){history.pushState(null,"",u),n(u)}function i(u){history.replaceState(null,"",u),n(u)}function c(u){history.replaceState(null,"","/Reload"),n("/Reload"),setTimeout(()=>{const l=u.length?dt(u):location.pathname;history.pushState(null,"",l),n(l)},100)}return Tt(()=>{location.pathname==="/"&&location.search.startsWith("?/")&&i(location.search.substring(2)),addEventListener("click",u=>{const l=u.target?.closest("a");if(l){if(l.origin!==location.origin){l.target="_blank";return}u.preventDefault(),a(l.pathname)}}),addEventListener("popstate",u=>{u.preventDefault(),n(location.pathname)})}),r.jsx(Dt.Provider,{value:t,children:o})}class I{namespace;info;error;warn;debug;throw;constructor(...t){this.namespace=t.join(" > "),this.error=console.error.bind(this,this.baseColor(101,"error"),`
	`),this.warn=console.warn.bind(this,this.baseColor(103,"warn"),`
	`),this.info=console.info.bind(this,this.baseColor(104,"info"),`
	`),this.debug=console.debug.bind(this,this.baseColor(102,"debug"),`
	`),this.throw=console.log.bind(this,this.baseColor(105,"throw"),"↓ The Following Error is Thrown ↓")}With(...t){return new I(this.namespace,...t)}baseColor(t,e){return`\x1B[${t};30;1m ${e.toUpperCase()} \x1B[0m\x1B[100;97m ${P().format("YY-M-D H:m:s")} \x1B[1m\x1B[40;97m ${this.namespace} `}}const T={display:"flex"},_e={flexDirection:"column"},$={...T,..._e},er={...T,backgroundColor:p.colorNeutralBackground1,boxShadow:p.shadow4,...B.borderRadius(p.borderRadiusMedium)},We={whiteSpace:"pre-line"},Pt=60,Ct="1636px",qe={objectFit:"cover",objectPosition:"center"},Qe=b({pre:We});function q(o){const t=Qe(),{dispatchToast:e}=Kt();return{dispatch:s=>{const n=s.Error.message,a=n.indexOf("Exception:");let i=n;a!==-1&&(i=n.substring(a+10)),e(r.jsxs(_,{children:[r.jsx(W,{children:"Internal Error"}),r.jsx(ot,{subtitle:r.jsxs(st,{className:t.pre,children:[i,r.jsx("br",{}),"More Info, See Console"]}),children:r.jsx(st,{className:t.pre,children:s.Message})})]}),{intent:"error",timeout:1e4}),o.error(s)},dispatchToast:e}}const Xe=b({box:{...$,rowGap:p.spacingVerticalM},one:{...T,columnGap:p.spacingVerticalXXXL}}),Et=new I("Setting");function Vt({Open:o,Toggle:t,New:e}){const s=Xe(),n=It().instance.getActiveAccount(),[a,i]=g.useState(),[c,u]=g.useState(),[l,m]=g.useState(),{data:d,mutate:f}=E.User.Get.useMe(Et);g.useEffect(()=>{if(e||!d)return;const{Name:C,Phone:x,Address:D}=d;i(C),u(x),m(D)},[d]);const{dispatch:y,dispatchToast:Q}=q(Et),{run:X}=E.User.Post.useUpdate({manual:!0,onError(C,[x]){y({Message:`Failed ${e?"Create":"Update"} Info`,Error:C,Request:x})},onSuccess(C,[x]){f({...d,...x}),Q(r.jsxs(_,{children:[r.jsxs(W,{children:["Info ",e?"Created":"Updated"]}),r.jsxs(ot,{children:[x.Name,r.jsx("br",{}),x.Phone,r.jsx("br",{}),x.Address]})]}),{intent:"success"}),e&&(M.next(!1),M.complete(),M.closed=!0),t()}});return r.jsx(Nt,{open:o,onOpenChange:t,modalType:e?"alert":"modal",children:r.jsx(At,{children:r.jsxs(Ot,{children:[r.jsx(Zt,{children:e?"Welcome! Fill in your info to get started.":"Personal Information"}),r.jsxs(kt,{className:s.box,children:[r.jsxs("div",{className:s.one,children:[r.jsx(J,{content:"Full first and family names, will be used to the shipping label.",relationship:"description",withArrow:!0,children:r.jsx(L,{label:"Name",size:"large",required:!0,children:r.jsx(F,{size:"medium",value:a,maxLength:20,onChange:(C,x)=>i(x.value)})})}),r.jsx(J,{content:"Up to 20 digits, starting with an internation access code.",relationship:"description",withArrow:!0,children:r.jsx(L,{label:"Phone",size:"large",required:!0,children:r.jsx(F,{size:"medium",value:c,maxLength:20,onChange:(C,x)=>u(x.value)})})})]}),r.jsx(L,{label:"E-Mail",size:"large",children:r.jsx(H,{children:n?.username})}),r.jsx(J,{content:"Your full shipping address including street, number, ZIP, town and country. Separate lines by commas.",relationship:"description",withArrow:!0,children:r.jsx(L,{label:"Address",size:"large",required:!0,children:r.jsx(F,{size:"medium",value:l,maxLength:100,minLength:20,onChange:(C,x)=>m(x.value)})})})]}),r.jsxs(Gt,{children:[!e&&r.jsx(xt,{disableButtonEnhancement:!0,children:r.jsx(v,{appearance:"secondary",children:"Cancel"})}),r.jsx(v,{appearance:"primary",onClick:()=>X({EMail:n?.username,Name:a,Address:l,Phone:c}),children:"Submit"})]})]})})})}const M=new yt;function Ye(){const[o,{toggle:t}]=k();return Tt(()=>M.subscribe(e=>e&&t())),r.jsx(K,{children:r.jsx(Vt,{Open:o,Toggle:t,New:!0})})}const ct={Name:"AwaiShop"};class Je{constructor(t,e){this.DB=t,this.Name=e,this.Sto=t.table(e),this.Trim()}Sto;async Get(t,e){const s=await this.Sto.get(t);return s?e&&await rt.waitFor(e(s))||typeof s.Exp=="number"&&s.Exp<P().unix()?(await this.Sto.delete(t),null):s.Val:null}async GetOrSet(t,e,s,n){const a=await this.Get(t,n);return a||this.Set(t,await rt.waitFor(e()),s)}async Set(t,e,s){if(!e)throw TypeError("Value cannot be null");if(s===null)return await this.Sto.put({Id:t,Exp:s,Val:e}),e;const n=(s||P().add(1,"week")).unix();if(s&&n<P().unix())throw RangeError(`Expire time [${n}] cannot be less than now [${P().unix()}]`);return await this.Sto.put({Id:t,Exp:n,Val:e}),e}Trim(){return this.Sto.filter(t=>typeof t.Exp=="number"&&t.Exp<P().unix()).delete()}}const ut=new rt(ct.Name,{autoOpen:!1});ut.version(1).stores({Shared:"Id, Exp",ShopCart:"Id"});ut.open();const A=new Je(ut,"Shared"),ht=ut.table("ShopCart"),S=new te({auth:{clientId:"0ac3ee82-159d-407c-8539-7a9e1e3a1989",authority:"https://SoarCraft.b2clogin.com/SoarCraft.onmicrosoft.com/B2C_1_RegLog",knownAuthorities:["SoarCraft.b2clogin.com"],redirectUri:"https://awai.aloen.to/Login"},cache:{cacheLocation:"localStorage"},system:{loggerOptions:{loggerCallback(o,t){switch(o){case bt.Error:console.error(t);return;case bt.Warning:console.warn(t);return}}}}});async function Ht(){try{return(await S.acquireTokenSilent({scopes:[]})).idToken}catch(o){S.getActiveAccount()&&await S.loginRedirect(),console.warn(o)}}await S.initialize();await S.handleRedirectPromise();S.setActiveAccount(S.getAllAccounts()[0]);class Ft extends Error{constructor(){super("Please Login First")}}class Ke extends Error{constructor(){super("Server Returned False")}}class zt extends Error{constructor(){super("Server Returned Empty Response")}}function _t(o,t,e){e.useMemory||(e.setCache=n=>localStorage.setItem(o,JSON.stringify(n)),e.getCache=()=>JSON.parse(localStorage.getItem(o)||"{}"));const s=h(t,{staleTime:5e3,...e,cacheKey:o});return{...s,refresh:()=>{e.useMemory?ee(o):localStorage.removeItem(o),s.refresh()}}}class Wt{static async EnsureConnected(){return this.Hub.state===Y.Connected?Promise.resolve():((this.Hub.state===Y.Disconnected||this.Hub.state===Y.Disconnecting)&&await this.Hub.start(),new Promise(t=>{const e=setInterval(()=>{this.Hub.state===Y.Connected&&(clearInterval(e),t())},100)}))}static async Invoke(t,...e){return await this.EnsureConnected(),this.Hub.invoke(t,...e)}static EnsureLogin(){if(!S.getActiveAccount())throw new Ft}static EnsureTrue(t){if(!t)throw new Ke}static async HandleFileStream(t,e,s){const a=Math.ceil(t.size/30720);let i=0;for(;i<a;){const c=i*30720,u=Math.min(c+30720,t.size),l=t.slice(c,u),m=new FileReader,d=await new Promise((f,y)=>{m.onload=()=>f(new Uint8Array(m.result)),m.onerror=()=>y(m.error),m.readAsArrayBuffer(l)});e.next(d),s?.debug(`Sent chunk ${i+1}/${a}`),i++}e.complete()}static Index(t,e){return`${e}_${t}`}static reqPool=new Set;static async getLocker(t){if(this.reqPool.has(t))return new Promise(e=>{const s=setTimeout(()=>this.reqPool.delete(t),1e4),n=setInterval(()=>{this.reqPool.has(t)||(clearInterval(n),e(),clearTimeout(s))},100)})}static async GetVersionCache(t,e){const s=this.Index(t,e);await this.getLocker(s);const n=await A.Get(s),a=async()=>{this.reqPool.add(s);const i=await rt.waitFor(this.Invoke(e,t,n?.Version)),c=u=>{A.Set(s,{...u,QueryExp:P().add(10,"s").unix()},P().add(1,"w")).finally(()=>this.reqPool.delete(s))};if(i===!0)return c(n),n;if(!i)throw A.Sto.delete(s),new zt;return c(i),i};return n?(n.QueryExp<P().unix()&&a(),n):a()}static async GetTimeCache(t,e,s,...n){const a=this.Index(t,e);return await this.getLocker(a),await A.GetOrSet(a,()=>(this.reqPool.add(a),this.Invoke(e,...n)),s(P())).finally(()=>this.reqPool.delete(a))}static useTimeCache(t,e,s){const n=j(()=>this.Index(t,e));return _t(n,(...i)=>this.Invoke(e,...i),s)}static async UpdateCache(t,e,s,n){const a=this.Index(e,s),i=await A.Get(a);if(!i)return;const c=t(i);i.QueryExp?await A.Set(a,{...c,QueryExp:P().add(1,"m").unix()},P().add(1,"w")):await A.Set(a,c,n||null)}}class N extends Wt{static Log=["|","ShopNet"];static Hub=new $t().withUrl("https://awaishop.aloen.to:3389/Hub",{skipNegotiation:!0,transport:Ut.WebSockets,logMessageContent:!1,async accessTokenFactory(){const t=await Ht();return t||""}}).withAutomaticReconnect().withStatefulReconnect().withHubProtocol(new Rt).configureLogging(Mt.Information).build()}N.Hub.on("OnNewUser",()=>{M.next(!0),console.debug("OnNewUser")});class Ze extends N{static Categories(){return this.GetTimeCache("","GalleryGetCategories",t=>t.add(1,"m"))}static async Products(t){return await this.GetTimeCache(t,"GalleryGetProducts",s=>s.add(1,"m"),t)}}const ts={Get:Ze};class es extends N{static async Get(t){if(!/^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$/i.test(t))throw new Error(`Invalid ObjectId ${t}`);return await this.EnsureConnected(),this.Hub.stream("ObjectStorageGet",t)}static GetBySlice(t,e){const s=[];return A.GetOrSet(t,()=>new Promise((n,a)=>{this.Get(t).then(i=>i.subscribe({error(c){a(c)},next(c){s.push(c),e.debug("Received Slice",t,s.length)},complete(){n(s)}}))}))}}class ss extends N{static useDelete(t){return h(async e=>{this.EnsureLogin();const s=await this.Invoke("OrderDeleteCancelled",e);return this.EnsureTrue(s),s},t)}}class w extends Wt{static Log=["|","AdminNet"];static Hub=new $t().withUrl("https://awaishop.aloen.to:3389/AdminHub",{skipNegotiation:!0,transport:Ut.WebSockets,logMessageContent:!1,async accessTokenFactory(){const t=await Ht();if(t)return t;throw new Error("Please Login First")}}).withAutomaticReconnect().withStatefulReconnect().withHubProtocol(new Rt).configureLogging(Mt.Information).build();static Index(t,e){return`${e}_Admin_${t}`}}class wt extends N{static order="OrderEntity";static Order(t){return this.EnsureLogin(),this.GetVersionCache(t,this.order)}static comment="CommentEntity";static Comment(t){return this.EnsureLogin(),this.GetVersionCache(t,this.comment)}}class nt extends w{static Order(t){return this.EnsureLogin(),this.GetVersionCache(t,wt.order)}static Comment(t){return this.EnsureLogin(),this.GetVersionCache(t,wt.comment)}}class at extends w{static User(t){return this.EnsureLogin(),this.GetVersionCache(t,"UserEntity")}}class O extends N{static product="ProductEntity";static Product(t){return this.GetVersionCache(t,this.product)}static ProductUpdate(t,e){return this.UpdateCache(e,t,this.product)}static Lexical(t){return this.GetVersionCache(t,"LexicalEntity")}static photo="PhotoEntity";static Photo(t){return this.GetVersionCache(t,this.photo)}static PhotoUpdate(t,e){return this.UpdateCache(e,t,this.photo)}static Type(t){return this.GetVersionCache(t,"TypeEntity")}static Variant(t){return this.GetVersionCache(t,"VariantEntity")}static Combo(t){return this.GetVersionCache(t,"ComboEntity")}}class R extends O{static Log=[...super.Log,"Product","Get"];static async Basic(t,e){const s=e.With(...this.Log,"Basic"),n=await this.Product(t);if(!n)throw new Error(`Product ${t} Not Found`);const[a,i]=await this.PhotoList(t,e);return i?{Name:n.Name,Cover:i}:(s.warn(`Product ${t} has no photo`),{Name:n.Name,Cover:""})}static Limit(t){return this.Invoke("ProdGetLimit",t)}static async ComboItem(t,e){const s=e.With(...this.Log,"Combo"),n=await this.ComboList(t),a=[];for(const i of n){const c=await this.Combo(i),u={};for(const l of c.Types){const m=await this.Type(l);if(!m){s.error(`[Mismatch] Type ${l} not found. Combo ${i} : Product ${t}`);continue}const d=await this.Variant(m.VariantId);if(!d){s.error(`[Mismatch] Variant ${m.VariantId} not found. Combo ${i} : Type ${l} : Product ${t}`);continue}u[d.Name]=m.Name}a.push({Id:i,Stock:c.Stock,Combo:u})}return a}static ComboList(t){return this.GetTimeCache(t,"ProductGetComboList",e=>e.add(1,"m"),t)}static photoList="ProductGetPhotoList";static async PhotoList(t,e){const s=e.With(...this.Log,"PhotoList"),n=await this.GetTimeCache(t,this.photoList,a=>a,t).catch(s.error);return this.makePhotoList(t,n||[],s)}static async makePhotoList(t,e,s){let n=[],a="";for(const i of e){const c=await this.Photo(i).catch(s.error);c?(n.push(c),c.Cover&&(a=c.ObjectId)):s.warn(`Photo ${i} not found in Product ${t}`)}return n=n.sort((i,c)=>i.Order-c.Order),!a&&n.length>0?(s.warn(`Product ${t} has no cover photo, using first photo instead`),[n,n[0].ObjectId]):[n,a]}static usePhotoList(t,e){const s=j(()=>e.With(...this.Log,"PhotoList")),[n,a]=g.useState(),[i,c]=g.useState(),u=this.useTimeCache(t,this.photoList,{defaultParams:[t],onError:s.error});return ft(async()=>{const l=u.data;if(!l)return;const[m,d]=await this.makePhotoList(t,l,s);a(m),c(d)},[u.data]),{...u,data:[n,i]}}}class rs extends wt{static Log=[...super.Log,"Order","Get"];static async List(t){this.EnsureLogin();const e=t.With(...this.Log,"List"),s=await this.GetTimeCache("","OrderGetList",a=>a.add(1,"m")),n=[];for(const a of s){const i=await this.Order(a.OrderId);if(!i){e.warn(`[Mismatch] Order ${a.OrderId} not found`);continue}const c=[];for(const u of a.Products){const l=await O.Product(u);if(!l){e.warn(`[Mismatch] Product ${u} not found`);continue}c.push(l.Name)}n.push({Id:a.OrderId,Items:c,Quantity:a.Quantity,Status:i.Status,TrackNumber:i.TrackingNumber,OrderDate:i.CreateAt})}return n.sort((a,i)=>i.OrderDate.getTime()-a.OrderDate.getTime())}static items="OrderGetItems";static useItems(t,e,s){const n=j(()=>e.With(...this.Log,"Items")),[a,i]=g.useState(),c=(s?w:this).useTimeCache(t,this.items,{defaultParams:[t],onError:n.error});return ft(async()=>{const u=c.data;if(!u)return;const l=[];let m=0;for(const d of u){const f={};let y=0;for(const C of d.Types){const x=await O.Type(C);if(!x){n.warn(`[Mismatch] Type ${C} not found. Order : ${t}`);continue}const D=await O.Variant(x.VariantId);if(!D){n.warn(`[Mismatch] Variant ${x.VariantId} not found. Type : ${C}, Order : ${t}`);continue}f[D.Name]=x.Name,y=D.ProductId}const Q=await O.Product(y);if(!Q){n.warn(`[Mismatch] Product ${y} not found. Order : ${t}`);continue}let X="";if(!s){const[C,x]=await R.PhotoList(y,n);x||n.warn(`Product ${y} has no photo`),X=x}l.push({Id:m++,ProdId:y,Cover:X,Name:Q.Name,Type:f,Quantity:d.Quantity})}i(l)},[c.data]),{...c,data:a}}static useCmts(t,e,s){const n=j(()=>e.With(...this.Log,"Cmts")),[a,i]=g.useState(),c=(s?w:this).useTimeCache(t,"OrderGetCmts",{defaultParams:[t],onError:n.error});return ft(async()=>{const u=c.data;if(!u)return;const l=[];if(s)for(const m of u){const d=await nt.Comment(m);if(!d){n.warn(`[Mismatch] Comment ${m} not found. Order : ${t}`);continue}let f="Client";if(d.UserId){const y=await at.User(d.UserId);y?f=y.Name:n.warn(`[Mismatch] User ${d.UserId} not found. Order : ${t}`)}l.push({Content:d.Content,Time:d.CreateAt,User:f})}else for(const m of u){const d=await this.Comment(m);if(!d){n.warn(`[Mismatch] Comment ${m} not found. Order : ${t}`);continue}l.push({Content:d.Content,Time:d.CreateAt,User:d.Name||"You"})}i(l.sort((m,d)=>m.Time.getTime()-d.Time.getTime()))},[c.data]),{...c,data:a}}}class ns extends N{static useNew(t){return h((e,s)=>{this.EnsureLogin();const n=e.map(a=>({ProdId:a.ProdId,Type:Object.values(a.Type),Quantity:a.Quantity}));return this.Invoke("OrderPostNew",n,s)},t)}static useAppend(t){return h(async(e,s)=>{this.EnsureLogin();const n=await this.Invoke("OrderPostAppend",e,s);return this.EnsureTrue(n),n},t)}static useCancel(t){return h((e,s)=>(this.EnsureLogin(),this.Invoke("OrderPostCancel",e,s)),t)}static useReceived(t){return h(async e=>{this.EnsureLogin();const s=await this.Invoke("OrderPostReceived",e);return this.EnsureTrue(s),s},t)}}const as={Get:rs,Post:ns,Delete:ss},os={Get:R};class is extends N{static Log=[...super.Log,"User","Get"];static me="UserGetMe";static useMe(t,e){const s=j(()=>t.With(...this.Log,"Me")),{dispatch:n}=q(s);return _t(this.me,()=>(this.EnsureLogin(),this.GetVersionCache(0,this.me)),{manual:e,useMemory:!0,onError(i){i instanceof zt||(i instanceof Ft?s.info(i):n({Message:"Failed to Get Your Info",Error:i,Request:""}))}})}}class cs extends N{static useUpdate(t){return h(async e=>{this.EnsureLogin();const s=await this.Invoke("UserPostUpdate",e);return this.EnsureTrue(s),s},t)}}const us={Get:is,Post:cs},E={Gallery:ts,Product:os,User:us,Order:as,Storage:es},qt=g.createContext({});function z(){return g.useContext(qt)}const mt=new I("ShopCart","Context");function ls({children:o}){const[t,e]=g.useState([]);h(async()=>{const a=await ht.toArray(),i=[];for(const c of a){const u=await E.Product.Get.Basic(c.ProdId,mt);i.push({...c,...u})}e(i)},{onError:mt.error});async function s(a){for(let i=0;i<a.length;i++)a[i].Id=i;e([...a]),await ht.clear(),await ht.bulkPut(a.map(i=>({Id:i.Id,ProdId:i.ProdId,Type:i.Type,Quantity:i.Quantity})))}async function n(a,i,c){const u=await E.Product.Get.Basic(a,mt);t.push({...u,Id:t.length,ProdId:a,Type:i,Quantity:c}),s(t)}return r.jsx(qt.Provider,{value:{List:t,Add:n,Update:s},children:o})}const ds=b({box:{width:"-webkit-fill-available",marginTop:p.spacingVerticalXXXL,...B.padding(p.spacingVerticalXXXL,0),backgroundColor:p.colorNeutralBackgroundInverted},main:{...T,maxWidth:Ct,...B.margin(0,"auto")},logo:{width:"150px",filter:"invert(96%)"},otc:{color:"white"}});function hs(){const o=ds();return r.jsx("footer",{className:o.box,children:r.jsx("div",{className:o.main,children:r.jsx("img",{src:"/safari-pinned-tab.svg",className:o.logo})})})}const ms=b({box:{...T,flexGrow:1,height:"inherit",marginLeft:p.spacingHorizontalS,alignItems:"center"},div:{color:p.colorNeutralForegroundDisabled},link:{textDecorationLine:"unset !important"}});function ps(){const o=ms(),{Paths:t}=U(),e=t.at(0),s=t.at(1)||"Product";return e==="Admin"&&r.jsxs("div",{className:o.box,children:[r.jsx(st,{size:600,font:"monospace",className:o.div,children:"|"}),r.jsxs(se,{selectedValue:s,children:[r.jsx(G,{appearance:"subtle",href:"/Admin",className:o.link,children:r.jsx(lt,{value:"Product",children:"Product List"})}),r.jsx(G,{appearance:"subtle",href:"/Admin/Order",className:o.link,children:r.jsx(lt,{value:"Order",children:"Order List"})}),r.jsx(G,{appearance:"subtle",href:"/Admin/User",className:o.link,children:r.jsx(lt,{value:"User",children:"User List"})})]})]})}class gs extends w{static async Export(t){this.EnsureLogin(),await this.EnsureConnected();const e=[];return new Promise((s,n)=>{this.Hub.stream("ExportOrder").subscribe({error(a){t.error(a),n(a)},next(a){e.push(a),t.debug("Received Slice",e.length)},complete(){t.debug("Received All Slices",e.length),s(URL.createObjectURL(new Blob(e)))}})})}}class xs extends w{static Log=[...super.Log,"Order","Get"];static Count(){return this.EnsureLogin(),this.GetTimeCache("","OrderGetCount",t=>t.add(1,"m"))}static async List(t,e){this.EnsureLogin();const s=e.With(...this.Log,"List"),n=await this.GetTimeCache(t,"OrderGetList",i=>i.add(1,"m"),t),a=[];for(const i of n){const c=await nt.Order(i.OrderId);if(!c){s.warn(`[Mismatch] Order ${i.OrderId} not found`);continue}const u=[];for(const m of i.Products){const d=await O.Product(m);if(!d){s.warn(`[Mismatch] Product ${m} not found`);continue}u.push(d.Name)}const l=await at.User(c.UserId);if(!l){s.error(`[Mismatch] User ${c.UserId} not found`);continue}a.push({Id:i.OrderId,Items:u,Quantity:i.Quantity,Status:c.Status,TrackNumber:c.TrackingNumber,OrderDate:c.CreateAt,User:l.Name})}return a}static Order=nt.Order;static Export=gs.Export}class fs extends w{static useAppend(t){return h(async(e,s)=>{const n=await this.Invoke("OrderPostAppend",e,s);return this.EnsureTrue(n),n},t)}static useClose(t){return h((e,s)=>this.Invoke("OrderPostClose",e,s),t)}static useCancel=this.useClose;static useShip(t){return h(async(e,s)=>{const n=await this.Invoke("OrderPostShip",e,s);return this.EnsureTrue(n),n},t)}static useAccept(t){return h(async e=>{const s=await this.Invoke("OrderPostAccept",e);return this.EnsureTrue(s),s},t)}}const ws={Get:xs,Post:fs};class jt extends w{static Log=[...super.Log,"Product","Get"];static list="ProductGetList";static useList(t){const e=j(()=>t.With(...this.Log,"List"));return re(()=>this.GetTimeCache("",this.list,n=>n.add(1,"m")).catch(e.error))}static ListUpdate(t){return this.UpdateCache(t,"",this.list,P().add(1,"m"))}static Count(t){return this.GetTimeCache(t,"ProductGetCount",e=>e.add(1,"m"),t)}static async Name(t){const e=await R.Product(t);if(!e)throw new Error(`Product ${t} Not Found`);return e.Name}static async Category(t){const e=await R.Product(t);if(!e)throw new Error(`Product ${t} Not Found`);return e.Category}static async Variants(t,e){const s=e.With(...this.Log,"Variants"),n=await this.GetTimeCache(t,"ProductGetVariants",i=>i.add(1,"m"),t),a=[];for(const i of n){const c=await R.Variant(i.VariantId);if(!c){s.warn(`Variant ${i} Not Found. Product : ${t}`);continue}const u=[];for(const l of i.Types){const m=await R.Type(l);if(!m){s.warn(`Type ${l} Not Found. Variant : ${i.VariantId}, Product : ${t}`);continue}u.push(m.Name)}a.push({Id:i.VariantId,Name:c.Name,Types:u})}return a}}class ys extends w{static usePhoto(t){return h(async(e,s)=>{const n=await this.Invoke("ProductDeletePhoto",s);return this.EnsureTrue(n),n},t)}static useVariant(t){return h(async e=>{const s=await this.Invoke("ProductDeleteVariant",e);return this.EnsureTrue(s),s},t)}static useType(t){return h(async(e,s)=>{const n=await this.Invoke("ProductDeleteType",e,s);return this.EnsureTrue(n),n},t)}static useCombo(t){return h(async e=>{const s=await this.Invoke("ProductDeleteCombo",e);return this.EnsureTrue(s),s},t)}static useProduct(t){return h(async e=>{const s=await this.Invoke("ProductDeleteProduct",e);return this.EnsureTrue(s),jt.ListUpdate(n=>n.filter(a=>a!==e)),s},t)}static useCategory(t){return h(async e=>{const s=await this.Invoke("ProductDetachCategory",e);return this.EnsureTrue(s),O.ProductUpdate(e,n=>(n.Category=void 0,n)),s},t)}}class Ps extends w{static Log=[...super.Log,"Product","Patch"];static useName(t){return h(async(e,s)=>{const n=await this.Invoke("ProductPatchName",e,s);return this.EnsureTrue(n),n},t)}static useCategory(t){return h(async(e,s)=>{const n=await this.Invoke("ProductPatchCategory",e,s);return this.EnsureTrue(n),n},t)}static usePhoto(t,e){const s=j(()=>t.With(...this.Log,"Photo"));return h(async(n,a)=>{if(!a.type.startsWith("image/"))throw new TypeError("File is not an image");if(a.size>10*1024*1024)throw new RangeError("File is too large, max 10MB");await this.EnsureConnected();const i=new yt,c=this.Hub.invoke("ProductPatchPhoto",n,i);return await this.HandleFileStream(a,i,s),this.EnsureTrue(await c),!0},e)}static useCaption(t){return h(async(e,s)=>{const n=await this.Invoke("ProductPatchCaption",e,s);return this.EnsureTrue(n),O.PhotoUpdate(e,a=>(a.Caption=s,a)),n},t)}static useVariantName(t){return h(async(e,s)=>{const n=await this.Invoke("ProductPatchVariantName",e,s);return this.EnsureTrue(n),n},t)}static useType(t){return h(async(e,s,n)=>{const a=await this.Invoke("ProductPatchType",e,s,n);return this.EnsureTrue(a),a},t)}static useCombo(t){return h(async(e,s,n)=>{const a=await this.Invoke("ProductPatchCombo",e,s,n);return this.EnsureTrue(a),a},t)}}let Qt;function sr(o){Qt=o}class Cs extends w{static Log=[...super.Log,"Product","Post"];static useCreate(t){return h(async e=>{const s=await this.Invoke("ProductPostCreate",e);return jt.ListUpdate(n=>[s,...n]),s},t)}static useMovePhoto(t){return h(async(e,s)=>{const n=await this.Invoke("ProductPostMovePhoto",e,s);return this.EnsureTrue(n),n},t)}static usePhoto(t,e){const s=j(()=>t.With(...this.Log,"Photo"));return h(async(n,a)=>{if(!a.type.startsWith("image/"))throw new TypeError("File is not an image");if(a.size>10*1024*1024)throw new RangeError("File is too large, max 10MB");const i=new yt,c=this.Invoke("ProductPostPhoto",n,i);return await this.HandleFileStream(a,i,s),c},e)}static useVariant(t){return h((e,s)=>this.Invoke("ProductPostVariant",e,s),t)}static useType(t){return h((e,s)=>this.Invoke("ProductPostType",e,s),t)}static useCombo(t){return h((e,s,n)=>this.Invoke("ProductPostCombo",e,s,n),t)}static useLexical(t){return h(async e=>{const s=Qt?.getEditorState();let n;s&&!s.isEmpty()&&(n=JSON.stringify(s.toJSON()));const a=await this.Invoke("ProductPostDescription",e,n);return this.EnsureTrue(a),a},t)}}const js={Get:jt,Post:Cs,Patch:Ps,Delete:ys};class bs extends w{static useUser(t){return h(async e=>{const s=await this.Invoke("UserDeleteUser",e);return this.EnsureTrue(s),s},t)}static useAdmin(t){return h(async e=>{const s=await this.Invoke("UserDeleteAdmin",e);return this.EnsureTrue(s),s},t)}}class vs extends w{static async OrderUser(t){const e=await nt.Order(t);if(!e)throw new Error(`Order ${t} not found`);const s=await at.User(e.UserId);if(!s)throw new Error(`User ${e.UserId} not found in order ${t}`);return s}static async List(){const t=await this.GetTimeCache("","UserGetList",s=>s.add(1,"m")),e=[];for(const s of t){const n=await at.User(s);if(!n){console.warn(`User ${s} not found`);continue}e.push({Id:s,Name:n.Name,EMail:n.EMail,Admin:n.Admin})}return e}}class Es extends w{static useAdmin(t){return h(async e=>{const s=await this.Invoke("UserPostAdmin",e);return this.EnsureTrue(s),s},t)}}const Ls={Get:vs,Post:Es,Delete:bs},Xt={Product:js,Order:ws,User:Ls},Lt=new I("Admin","Order","ExportButton");function Ss(){const{Paths:o}=U(),t=o.at(0),e=o.at(1),{dispatch:s,dispatchToast:n}=q(Lt),{run:a,loading:i}=h(()=>Xt.Order.Get.Export(Lt),{manual:!0,onError(c,u){s({Message:"Failed Export Orders",Request:u,Error:c})},onSuccess(c){n(r.jsx(_,{children:r.jsx(W,{children:"Orders Exported"})}),{intent:"success"});const u=document.createElement("a");u.href=c,u.download=`AllOrders_${new Date().toISOString()}.xlsx`,u.click()}});return t==="Admin"&&e==="Order"&&r.jsx(v,{appearance:"subtle",icon:r.jsx(ne,{}),onClick:a,disabled:i,children:"Export Orders"})}const Ts=b({body:$}),Is=new I("Admin","Product","AddButton");function Ns(){const{Nav:o,Paths:t}=U(),e=t.at(0),s=t.at(1),n=Ts(),[a,i]=g.useState(""),{dispatch:c,dispatchToast:u}=q(Is),{run:l,loading:m}=Xt.Product.Post.useCreate({manual:!0,onError(d,f){c({Message:`Failed Create ${a}`,Request:f,Error:d})},onSuccess(d){u(r.jsxs(_,{children:[r.jsx(W,{children:"New Product Created"}),r.jsxs(ot,{children:[d," ",a]})]}),{intent:"success"}),o("Admin",d),i("")}});return e==="Admin"&&!s&&r.jsxs(Nt,{children:[r.jsx(xt,{disableButtonEnhancement:!0,children:r.jsx(v,{appearance:"primary",icon:r.jsx(ae,{}),children:"New Product"})}),r.jsx(At,{children:r.jsxs(Ot,{children:[r.jsx(kt,{className:n.body,children:r.jsx(F,{required:!0,size:"large",value:a,maxLength:15,appearance:"underline",onChange:(d,f)=>i(f.value),contentBefore:r.jsx(oe,{children:"Give A Name"})})}),r.jsxs(Gt,{children:[r.jsx(xt,{disableButtonEnhancement:!0,children:r.jsx(v,{appearance:"secondary",children:"Cancel"})}),r.jsx(v,{disabled:m,appearance:"primary",onClick:()=>l(a),children:"Create"})]})]})})]})}function As(){const{Paths:o,Search:t,Put:e}=U(),s=o.at(0),n=o.at(1);return s==="Admin"&&n==="User"&&r.jsxs(r.Fragment,{children:[r.jsx(F,{placeholder:"Search by E-Mail",contentBefore:r.jsx(ie,{}),appearance:"underline",onChange:(a,i)=>{i.value?t.set("search",i.value):t.delete("search"),e(t)}}),r.jsx(ce,{label:"Only Admin",checked:t.get("admin")==="",onChange:(a,i)=>{i.checked?t.set("admin",""):t.delete("admin"),e(t)}})]})}const Os=new I("Avatar","Menu");function ks(){const[o,{toggle:t}]=k(),[e,{toggle:s}]=k(),{instance:n}=It(),[a,{set:i}]=k(!0);g.useEffect(()=>{M.subscribe(m=>i(!m))},[]);const{data:c}=E.User.Get.useMe(Os),u=n.getActiveAccount(),l=u?.name||u?.username;return r.jsxs(r.Fragment,{children:[r.jsxs(ue,{open:o,onOpenChange:t,children:[r.jsx(le,{children:r.jsx(de,{size:36,active:o?"active":"unset",name:l})}),r.jsx(he,{children:r.jsxs(me,{children:[r.jsx(K,{children:r.jsxs(pe,{children:["Hi ",l]})}),r.jsx(ge,{children:r.jsx(V,{onClick:()=>n.loginRedirect(),children:"Login"})}),r.jsxs(K,{children:[r.jsx(G,{appearance:"subtle",href:"/History",children:r.jsx(V,{children:"History"})}),c?.Admin&&r.jsx(G,{appearance:"subtle",href:"/Admin",children:r.jsx(V,{children:"Admin"})}),r.jsx(V,{onClick:s,children:"Setting"}),r.jsx(V,{onClick:()=>n.logoutRedirect(),children:"Logout"})]})]})})]}),a&&r.jsx(K,{children:r.jsx(Vt,{Open:e,Toggle:s})})]})}function Yt({Items:o,Columns:t,NoHeader:e}){return r.jsxs(xe,{items:o||[],columns:t,getRowId:s=>s.Id,children:[!e&&r.jsx(fe,{children:r.jsx(vt,{children:({renderHeaderCell:s})=>s()})}),r.jsx(we,{children:({item:s,rowId:n})=>r.jsx(vt,{children:({renderCell:a})=>a(s)},n)}),!o&&r.jsx(ye,{size:48})]})}function Gs({Guid:o,Log:t,...e}){const s=j(()=>t.With("GuidImage")),{data:n,run:a}=h(E.Storage.GetBySlice.bind(E.Storage),{manual:!0,onError:s.error});return g.useEffect(()=>{o&&a(o,s)},[o]),r.jsx(Bt,{...e,src:n?URL.createObjectURL(new Blob(n)):"https://placehold.co/400?text=Loading..."})}const St=b({unset:{flexBasis:"unset",flexGrow:0},img:{...qe,aspectRatio:"1",marginTop:p.spacingVerticalXS,marginBottom:p.spacingVerticalXS}});function $s(o,t){const e={width:`${o}px`};return Z({columnId:"Cover",renderHeaderCell:()=>{const s=St();return r.jsx(Pe,{className:s.unset,children:r.jsx("div",{style:e})})},renderCell(s){const n=St();return r.jsx(tt,{className:n.unset,children:r.jsx(Gs,{className:n.img,style:e,Guid:s.Cover,Log:t})})}})}function Us(o){const{List:t}=z(),{data:e}=h(()=>E.Product.Get.Limit(o)),s=e||3;let n=0;for(const a of t)if(a.ProdId===o&&(n+=a.Quantity),n>=s)return[!0,s,n];return[!1,s,n]}const pt=b({prod:{...$,alignItems:"flex-start",justifyContent:"center"},qua:{flexBasis:"12%",flexGrow:0},act:{flexBasis:"7%",flexGrow:0}}),Rs=[Z({columnId:"Product",renderCell(o){return r.jsxs(tt,{className:pt().prod,children:[r.jsx(G,{href:`/Product/${o.ProdId}`,appearance:"subtle",children:r.jsx(Ce,{children:o.Name})}),r.jsx(je,{children:Object.values(o.Type).reduce((t,e)=>`${t} ${e},`,"")})]})}}),Z({columnId:"Quantity",renderCell(o){const{List:t,Update:e}=z(),[s,n]=Us(o.ProdId);return r.jsx(tt,{className:pt().qua,children:r.jsx(be,{min:1,max:n,value:o.Quantity,onChange:(a,i)=>{const c=parseInt(i.value||i.displayValue);isNaN(c)||c<1||c>n||s&&c>=o.Quantity||(o.Quantity=c,e(t))}})})}}),Z({columnId:"Action",renderCell(o){const{List:t,Update:e}=z();return r.jsx(tt,{className:pt().act,children:r.jsx(v,{appearance:"subtle",icon:r.jsx(ve,{}),onClick:()=>e(t.filter(s=>s.Id!==o.Id))})})}})];function Jt(o){return[$s(44,o),...Rs]}const Ms=b({person:T,inf:{...$,flexBasis:"50%",rowGap:p.spacingVerticalM}});function Bs({Log:o}){const t=Ms(),e=j(()=>o.With("PersonaInfo")),{data:s}=E.User.Get.useMe(e);return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:t.person,children:[r.jsx("div",{className:t.inf,children:r.jsx(L,{label:"Name",size:"large",children:r.jsx(H,{children:s?.Name})})}),r.jsx("div",{className:t.inf,children:r.jsx(L,{label:"Phone",size:"large",children:r.jsx(H,{children:s?.Phone})})})]}),r.jsx(L,{label:"E-Mail",size:"large",children:r.jsx(H,{children:s?.EMail})}),r.jsx(L,{label:"Address",size:"large",children:r.jsx(H,{children:s?.Address})})]})}const Ds=b({body:{...$,rowGap:p.spacingVerticalXL},sub:{width:"fit-content",alignSelf:"flex-end"}}),gt=new I("TopNavBar","ShopCart","Confirm");function Vs(){const[o,t]=g.useState(),[e,{toggle:s}]=k(),{List:n,Update:a}=z(),{Nav:i}=U(),c=Ds(),{dispatch:u,dispatchToast:l}=q(gt),{run:m}=E.Order.Post.useNew({manual:!0,onError(d,f){u({Message:"Failed Create Order",Request:f,Error:d})},onSuccess(d){l(r.jsxs(_,{children:[r.jsx(W,{children:"Order Placed"}),r.jsxs(ot,{children:["Order Id: ",d]})]}),{intent:"success"}),a([]),s(),i("History",d)}});return r.jsxs(r.Fragment,{children:[r.jsx(v,{appearance:"primary",onClick:s,disabled:!n.length,children:"Checkout"}),r.jsxs(Ee,{open:e,onOpenChange:s,position:"end",size:"medium",modalType:"alert",children:[r.jsx(Le,{children:r.jsx(Se,{action:r.jsx(v,{appearance:"subtle",icon:r.jsx(Te,{}),onClick:s}),children:"Confirm Order"})}),r.jsx(Ie,{children:r.jsxs("div",{className:c.body,children:[r.jsx(Bs,{Log:gt}),r.jsx(Yt,{Items:n,Columns:j(()=>Jt(gt)),NoHeader:!0}),r.jsx(L,{label:"Comment",size:"large",children:r.jsx(Ne,{value:o,onChange:(d,f)=>t(f.value),maxLength:1e3})}),r.jsx(v,{appearance:"primary",className:c.sub,disabled:!n.length,onClick:()=>m(n,o),children:"Submit"})]})})]})]})}const Hs=b({conf:{...T,width:"100%",alignItems:"center",justifyContent:"space-between",marginTop:p.spacingVerticalS,columnGap:p.spacingHorizontalL},tooltip:{backgroundColor:p.colorBrandBackground,color:p.colorNeutralForegroundInverted,...B.borderRadius(p.borderRadiusCircular)}}),Fs=new I("TopNavBar","ShopCart");function zs(){const[o,{toggle:t}]=k(),[e,{toggle:s}]=k(),n=Hs(),{List:a}=z();return Ae(()=>{if(o)return;s();const i=setTimeout(s,2e3);return()=>clearTimeout(i)},[a]),r.jsxs(Oe,{withArrow:!0,open:o,onOpenChange:t,children:[r.jsx(ke,{disableButtonEnhancement:!0,children:r.jsx(J,{visible:e,withArrow:!0,content:{children:"↑",className:n.tooltip},relationship:"inaccessible",children:r.jsx(Ge,{icon:r.jsx($e,{}),appearance:"subtle",size:"large",checked:o})})}),r.jsxs(Ue,{children:[r.jsx(Yt,{Items:a,Columns:j(()=>Jt(Fs)),NoHeader:!0}),r.jsxs("div",{className:n.conf,children:[a.map(i=>i.Quantity).reduce((i,c)=>i+c,0)," items in shopping cart",r.jsx(Vs,{})]})]})]})}const _s=b({navBox:{position:"fixed",top:0,width:"100%",height:`${Pt}px`,...B.padding(0,p.spacingHorizontalXXXL),backgroundColor:"#fff",boxSizing:"border-box",boxShadow:p.shadow4},navBar:{...T,maxWidth:Ct,height:"100%",...B.margin(0,"auto"),alignItems:"center",justifyContent:"space-between"},logoBox:{...T,columnGap:p.spacingHorizontalL,alignItems:"center"},logoText:{color:p.colorBrandForeground2}});function Ws(){const o=_s();return r.jsx(Re,{children:r.jsx("header",{className:o.navBox,children:r.jsxs("nav",{className:o.navBar,children:[r.jsxs(G,{className:o.logoBox,href:"/",appearance:"subtle",children:[r.jsx(Bt,{src:"/Awai.png",height:Pt}),r.jsx(st,{size:600,font:"monospace",className:o.logoText,children:ct.Name})]}),r.jsx(ps,{}),r.jsxs("div",{className:o.logoBox,children:[r.jsx(Ns,{}),r.jsx(As,{}),r.jsx(Ss,{}),r.jsx(zs,{}),r.jsx(ks,{})]})]})})})}function qs(){const{Rep:o}=U();return setTimeout(()=>o("/"),3e3),r.jsxs(r.Fragment,{children:[r.jsxs(Me,{children:[r.jsxs("title",{children:["Redirect - Not Found - ",ct.Name]}),r.jsx("meta",{name:"robots",content:"noindex, nofollow"})]}),r.jsx(et,{size:"huge",label:"Redirecting..."})]})}const Qs=b({body:{...$,minWidth:"375px",position:"absolute",marginTop:`${Pt}px`,width:"100%",minHeight:"-webkit-fill-available",justifyContent:"space-between",backgroundColor:p.colorNeutralBackground2},content:{...$,maxWidth:Ct,width:"-webkit-fill-available",marginLeft:"auto",marginRight:"auto",paddingLeft:p.spacingHorizontalM,paddingRight:p.spacingHorizontalM,paddingTop:p.spacingVerticalXXXL}});function Xs(){const o=Qs(),{Paths:t}=U(),e=t.at(0),s=g.useMemo(()=>{switch(e){case"Product":return r.jsx(Ys,{});case"Admin":return r.jsx(Js,{});case"History":return r.jsx(Ks,{});case"Login":return r.jsx(et,{size:"huge",label:"Login Redirecting..."});case"Reload":return r.jsx(et,{size:"huge",label:"Reloading..."});case"":case void 0:return r.jsx(Zs,{});default:return r.jsx(qs,{})}},[e]);return r.jsxs(r.Fragment,{children:[r.jsx(Ws,{}),r.jsxs("div",{className:o.body,children:[r.jsx("main",{className:o.content,children:r.jsx(g.Suspense,{fallback:r.jsx(et,{}),children:s})}),r.jsx(hs,{})]}),r.jsx(Ye,{})]})}const Ys=g.lazy(()=>it(()=>import("./index-D1TElIid.js"),__vite__mapDeps([0,1,2,3]))),Js=g.lazy(()=>it(()=>import("./index-Bc6ZVE9G.js"),__vite__mapDeps([4,1,5,2]))),Ks=g.lazy(()=>it(()=>import("./index-V7ajPSXO.js"),__vite__mapDeps([6,1,5]))),Zs=g.lazy(()=>it(()=>import("./index-7MIz2yz2.js"),__vite__mapDeps([7,1])));Be.createRoot(document.getElementById(ct.Name)).render(r.jsx(De,{theme:Ve,children:r.jsx(ze,{children:r.jsx(He,{instance:S,children:r.jsxs(ls,{children:[r.jsx(Fe,{pauseOnHover:!0}),r.jsx(Xs,{})]})})})}));export{Xt as A,er as B,qe as C,ct as D,T as F,Gs as G,E as H,I as L,$s as M,Wt as S,$ as a,Us as b,U as c,_e as d,Yt as e,q as f,_t as g,sr as h,z as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/index-D1TElIid.js","assets/vendor-C9L1vlTP.js","assets/Lazy-Sgn6FVQu.js","assets/index-Cxy6evux.css","assets/index-Bc6ZVE9G.js","assets/Columns-DUOWrMWg.js","assets/index-V7ajPSXO.js","assets/index-7MIz2yz2.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
