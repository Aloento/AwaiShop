import{_ as G,c as A,i as v,L,F as B,l as D,t as P,k as H,a8 as q,H as y,d as e,ab as c,ar as u,aQ as R,n as E,a7 as I,a9 as O,aa as k,B as N,r as F,ac as M,aR as $,ah as Q,al as U,am as W,an as _,ao as V,ap as K,aq as J,ad as X,aC as Y,ae as o,af as i,ag as h,aS as Z,aK as ee,aT as re}from"./index-tz5uvGsB.js";const se={root:"fui-Caption1Stronger"},ne=G({root:{Bahqtrf:"fk6fouc",Be2twd7:"fy9rknc",Bhrd7zp:"flh3ekv",Bg96gwp:"fwrc4pm"}},{d:[".fk6fouc{font-family:var(--fontFamilyBase);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".flh3ekv{font-weight:var(--fontWeightBold);}",".fwrc4pm{line-height:var(--lineHeightBase200);}"]}),ae=A({useStyles:ne,className:se.root,displayName:"Caption1Stronger"}),le=v({flex:B,box:{...D,flexBasis:"50%",rowGap:P.spacingVerticalM}}),T=new L("Order","Info");function te({OrderId:r,Order:s,Admin:n}){const a=le(),{data:m}=H(()=>q.User.Get.OrderUser(r),{manual:!n,onError:T.error}),{data:j}=y.User.Get.useMe(T,{manual:n}),l=n?m:j;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:a.flex,children:[e.jsx("div",{className:a.box,children:e.jsx(c,{label:"Name",size:"large",children:e.jsx(u,{children:l?.Name})})}),e.jsx("div",{className:a.box,children:e.jsx(c,{label:"Phone",size:"large",children:e.jsx(u,{children:l?.Phone})})})]}),e.jsxs("div",{className:a.flex,children:[e.jsx("div",{className:a.box,children:e.jsx(c,{label:"Order Date",size:"large",children:e.jsx(u,{children:s?.CreateAt.toLocaleDateString()})})}),e.jsx("div",{className:a.box,children:e.jsx(c,{label:"Status",size:"large",children:e.jsx(u,{children:s?.Status})})})]}),e.jsxs("div",{className:a.flex,children:[e.jsx("div",{className:a.box,children:e.jsx(c,{label:"E-Mail",size:"large",children:e.jsx(u,{children:l?.EMail})})}),!n&&e.jsx("div",{className:a.box,children:e.jsx(c,{label:"Tracking Number",size:"large",children:e.jsx(u,{children:s?.TrackingNumber})})})]}),e.jsx(c,{label:"Address",size:"large",children:e.jsx(u,{children:l?.Address})})]})}const ce=v({body:{...D,alignItems:"flex-start"}});function ie({OrderId:r,Status:s,Refresh:n,ParentLog:a}){const m=R(()=>a.With("Action")),j=ce(),{Reload:l}=E(),{dispatch:d,dispatchToast:p}=I(m),{run:g}=y.Order.Post.useReceived({manual:!0,onError(C,t){d({Message:"Failed Mark Receive",Request:t,Error:C})},onSuccess(){p(e.jsx(O,{children:e.jsx(k,{children:"Order Received"})}),{intent:"success"}),n()}}),{run:b}=y.Order.Delete.useDelete({manual:!0,onError(C,t){d({Message:"Failed Delete Order",Request:t,Error:C})},onSuccess(){p(e.jsx(O,{children:e.jsx(k,{children:"Order Deleted"})}),{intent:"success"}),l("History")}});switch(s){case"Pending":case"Processing":case"Finished":case"Returning":return null}return e.jsx(c,{label:"Action",size:"large",children:e.jsxs("div",{className:j.body,children:[s==="Cancelled"&&e.jsx(N,{appearance:"subtle",onClick:()=>b(r),children:"Delete Order"}),s==="Shipping"&&e.jsx(N,{appearance:"subtle",onClick:()=>g(r),children:"I Received Order"})]})})}const oe=v({body:{...B,justifyContent:"space-between"}});function de({OrderId:r,Status:s,Refresh:n,ParentLog:a}){const m=R(()=>a.With("Append")),j=oe(),[l,d]=F.useState(),{dispatch:p,dispatchToast:g}=I(m),{run:b}=y.Order.Post.useAppend({manual:!0,onError(t,f){p({Message:"Failed Append Comment",Request:f,Error:t})},onSuccess(){g(e.jsx(O,{children:e.jsx(k,{children:"Comment Appended"})}),{intent:"success"}),n()}}),{run:C}=y.Order.Post.useCancel({manual:!0,onError(t,f){p({Message:"Failed Cancel Order",Request:f,Error:t})},onSuccess(){g(e.jsx(O,{children:e.jsx(k,{children:"Order Canceled"})}),{intent:"success"}),n()}});switch(s){case"Cancelled":case"Finished":return null}return e.jsxs(e.Fragment,{children:[e.jsx(c,{label:"Append",size:"large",children:e.jsx(M,{value:l,onChange:(t,f)=>d(f.value),maxLength:1e3})}),e.jsxs("div",{className:j.body,children:[!(s==="Finished"||s==="Returning")&&e.jsxs(N,{onClick:()=>C(r,l),children:[s==="Shipping"?"Ask Return":"Cancel Order"," with Reason"]}),e.jsx(N,{appearance:"primary",onClick:()=>b(r,l),children:"Add Comment"})]})]})}function ue({Comments:r}){return e.jsx(c,{label:"Comment",size:"large",children:r?.length===0?e.jsx(u,{children:"No Comment"}):r?.map((s,n)=>e.jsxs("div",{children:[e.jsxs(ae,{children:[s.User," ",s.Time.toLocaleString()]}),e.jsx("br",{}),e.jsx($,{children:s.Content})]},n))})}const S=v({body:{...D,rowGap:P.spacingVerticalL},prod:{...D,alignItems:"flex-start",justifyContent:"center"},qua:{flexBasis:"10%",flexGrow:0,justifyContent:"center"}}),xe=[o({columnId:"Product",renderHeaderCell(){return e.jsx(i,{children:"Product Name & Types"})},renderCell(r){return e.jsxs(h,{className:S().prod,children:[e.jsx(Z,{href:`/Product/${r.ProdId}`,appearance:"subtle",children:e.jsx(ee,{children:r.Name})}),e.jsx(re,{children:Object.values(r.Type).reduce((s,n)=>`${s} ${n},`,"")})]})}}),o({columnId:"Quantity",renderHeaderCell(){return e.jsx(i,{className:S().qua,children:"Quantity"})},renderCell(r){return e.jsx(h,{className:S().qua,children:r.Quantity})}})];function he({OrderId:r,ParentLog:s}){const n=R(()=>s.With("Detail")),a=S(),[m,{setTrue:j,setFalse:l}]=Q(),{Nav:d,Paths:p}=E(),g=parseInt(p.at(1)),{data:b,run:C}=H(()=>y.Order.Get.Detail(r,n),{manual:!0,onError:n.error}),{data:t,run:f}=H(()=>y.Order.Get.Order(r),{onError(z){d("History"),n.error(z)},manual:!0});function w(){f(),C()}return F.useEffect(()=>{g===r?(w(),j()):l()},[g]),e.jsxs(e.Fragment,{children:[e.jsx(N,{appearance:"subtle",icon:e.jsx(U,{}),onClick:()=>d("History",r)}),e.jsxs(W,{open:m,position:"end",size:"medium",modalType:"alert",children:[e.jsx(_,{children:e.jsx(V,{action:e.jsx(N,{appearance:"subtle",icon:e.jsx(K,{}),onClick:()=>d("History")}),children:"Order Detail"})}),e.jsx(J,{children:e.jsxs("div",{className:a.body,children:[e.jsx(te,{OrderId:r,Order:t}),e.jsx(X,{Items:b?.ShopCart||[],Columns:[Y(44,n),...xe]}),e.jsx(ue,{Comments:b?.Comments}),e.jsx(de,{OrderId:r,Status:t?.Status,Refresh:w,ParentLog:n}),e.jsx(ie,{OrderId:r,Status:t?.Status,Refresh:w,ParentLog:n})]})})]})]})}const x=v({five:{flexBasis:"5%",flexGrow:0},ten:{flexBasis:"10%",flexGrow:0},two:{flexBasis:"2.5%",flexGrow:0}}),me=[o({columnId:"OrderId",renderHeaderCell:()=>e.jsx(i,{className:x().five,children:"Order Id"}),renderCell(r){return e.jsx(h,{className:x().five,children:r.Id})}}),o({columnId:"Products",renderHeaderCell:()=>e.jsx(i,{children:"Products"}),renderCell(r){return e.jsxs(h,{children:[r.Items[0]," ",r.Items.length>1&&`& +${r.Items.length-1}`]})}}),o({columnId:"OrderDate",renderHeaderCell:()=>e.jsx(i,{children:"Order Date"}),renderCell(r){return e.jsx(i,{children:r.OrderDate.toLocaleDateString()})}}),o({columnId:"TrackNumber",renderHeaderCell:()=>e.jsx(i,{children:"Track Number"}),renderCell(r){return e.jsx(h,{children:r.TrackNumber})}}),o({columnId:"Quantity",renderHeaderCell:()=>e.jsx(i,{className:x().ten,children:"Quantity"}),renderCell(r){return e.jsx(h,{className:x().ten,children:r.Quantity})}}),o({columnId:"Status",renderHeaderCell:()=>e.jsx(i,{className:x().ten,children:"Order State"}),renderCell(r){return e.jsx(h,{className:x().ten,children:r.Status})}})];function pe(r){return[...me,o({columnId:"Detail",renderHeaderCell:()=>e.jsx(i,{className:x().two,children:"Detail"}),renderCell(s){return e.jsx(h,{className:x().two,children:e.jsx(he,{OrderId:s.Id,ParentLog:r})})}})]}export{pe as H,te as O,ue as a};
