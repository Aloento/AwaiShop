import{j as e,s as b,t as c,B as A,ab as B,ac as I,X as z,a4 as E,N as O,ad as D,ae as w}from"./components-P3HMgWxx.js";import{b as h,j as F,i as U,H as V}from"./tools-BeP_WXzy.js";import{L as N,H as x,C as $,B as R,a as C,u as q,b as k,F as j,c as M,D as Q,d as W}from"./index-DQ4A6yrT.js";import{r as m}from"./react-mhcLWgJf.js";import{ap as f}from"./fluentui-D10euT8-.js";import{L as _}from"./Lazy-Dvq2p23w.js";import"./vendor-Cg4l60Qw.js";import"./rx-BIoNU6Ta.js";import"./signalr-wWpYR44r.js";const Y=f({img:{aspectRatio:"1",...$,...b.borderRadius(c.borderRadiusMedium)}}),P="https://placehold.co/1000?text=Loading...",S=new N("Product","Carousel");function J({Id:s}){const a=Y(),[n,o]=m.useState([[P]]);return h(()=>x.Product.Get.PhotoList(s,S),{async onSuccess([r]){o(Array(r.length).fill([P]));for(let t=0;t<r.length;t++)x.Storage.GetBySlice(r[t].ObjectId,S).then(i=>{o(l=>{const d=[...l];return d[t]=[URL.createObjectURL(new Blob(i)),r[t].Caption],d})})},onError:S.error}),e.jsx(F.Carousel,{showArrows:!0,children:n.map((r,t)=>e.jsxs("div",{children:[e.jsx("img",{className:a.img,src:r[0]}),r[1]&&e.jsx("p",{className:"legend",children:r[1]})]},t))})}const T=m.createContext({});function y(){return m.useContext(T)}function K({children:s}){const[a,n]=m.useState({}),[o,r]=m.useState([]);return e.jsx(T.Provider,{value:{Current:a,Update:n,Combo:o.find(t=>U(t.Combo,a)),SetAll:r},children:s})}const Z=f({lex:{...R,...b.padding(c.spacingHorizontalXL)},skel:{...C,rowGap:c.spacingVerticalM}});function ee({ProdId:s}){const a=Z(),{data:n,loading:o}=h(()=>x.Product.Get.Lexical(s));return o||!n?null:e.jsx("div",{className:a.lex,children:e.jsx(_,{Display:!0,State:n.Description})})}function se({ProdId:s,Quantity:a}){const{List:n,Add:o,Update:r}=q(),{Current:t,Combo:i}=y(),[l]=k(s);return e.jsx(A,{appearance:"primary",disabled:l||!i?.Stock,onClick:()=>{const d=n.find(u=>{if(u.ProdId===s){const p=Object.keys(t).sort(),L=Object.keys(u.Type).sort();for(let g=0;g<L.length;g++){const X=t[p[g]],H=u.Type[L[g]];if(X!==H)return!1}return!0}return!1});if(!d){o(s,t,a);return}d.Quantity++,r(n)},children:"ADD TO CART"})}const te=f({fore:{color:c.colorBrandForeground1},quan:{...C,rowGap:c.spacingVerticalS},add:{...j,justifyContent:"space-between",columnGap:c.spacingHorizontalM},stock:{...j,justifyContent:"space-between"}});function oe({Id:s}){const a=te(),{Combo:n}=y(),[o,r,t]=k(s),[i,l]=m.useState(1);return e.jsxs("div",{className:a.quan,children:[e.jsxs("div",{className:a.stock,children:[e.jsx(B,{className:a.fore,children:"QUANTITY"}),e.jsxs(I,{className:a.fore,children:[n?.Stock||0," in stock"]})]}),e.jsxs("div",{className:a.add,children:[e.jsx(z,{appearance:"underline",value:i,min:1,max:r-t,disabled:!n?.Stock,onChange:(d,u)=>{const p=parseInt(u.value||u.displayValue);isNaN(p)||p<1||p>r-t||l(p)}}),e.jsx(se,{ProdId:s,Quantity:i})]})]})}const re=f({fore:{color:c.colorBrandForeground1,textTransform:"uppercase"},btn:b.borderColor(c.colorBrandForeground1),vari:{...C,rowGap:c.spacingVerticalS},radio:{...j,flexWrap:"wrap",rowGap:c.spacingHorizontalS,columnGap:c.spacingHorizontalM}});function ae({Variant:s,Types:a}){const n=re(),{Current:o,Update:r}=y();return e.jsxs("div",{className:n.vari,children:[e.jsxs(B,{className:n.fore,children:["SELECT ",s,": ",o[s]]}),e.jsx("div",{className:n.radio,children:a.map((t,i)=>e.jsx(E,{appearance:"outline",className:n.btn,checked:o[s]===t,onClick:()=>r({...o,[s]:t}),children:t},i))})]})}const G=new N("Product","RadioGroup");function ne({ProdId:s}){const{Update:a,SetAll:n}=y(),[o,r]=m.useState([]),{loading:t}=h(()=>x.Product.Get.ComboItem(s,G),{onError:G.error,onSuccess(i){const l={};for(const d of i)for(const[u,p]of Object.entries(d.Combo))l.hasOwnProperty(u)?l[u].add(p):l[u]=new Set([p]);n(i),a(i[0].Combo),r(Object.entries(l).map(([d,u])=>[d,Array.from(u)]))}});return t?e.jsx(O,{size:72}):o.map(([i,l],d)=>e.jsx(ae,{Variant:i,Types:l},d))}const ce=f({info:{...j,columnGap:c.spacingHorizontalXXXL,"@media screen and (max-width: 600px)":{flexWrap:"wrap"}},detail:{...R,...W,rowGap:c.spacingVerticalXL,paddingTop:c.spacingVerticalM,paddingLeft:c.spacingHorizontalXXL,paddingRight:c.spacingHorizontalXXL,paddingBottom:c.spacingHorizontalXXL},lex:{...C,flexBasis:"50%",flexShrink:0,rowGap:c.spacingVerticalXL,"@media screen and (max-width: 600px)":{flexBasis:"100%"}},fore:{color:c.colorBrandForeground1}}),v=new N("Product");function je(){const s=ce(),{Nav:a,Paths:n}=M(),o=parseInt(n.at(1)),{data:r}=h(()=>x.Product.Get.Basic(o,v),{onBefore(){isNaN(o)&&a("/")},onError(t){a("/"),v.error(t)}});return e.jsxs(K,{children:[e.jsx(V,{children:e.jsxs("title",{children:[r?.Name||""," - ",Q.Name]})}),e.jsxs("div",{className:s.info,children:[e.jsx(J,{Id:o}),e.jsxs("div",{className:s.lex,children:[e.jsxs("div",{className:s.detail,children:[e.jsx(D,{className:s.fore,children:r?.Name||"Loading..."}),e.jsx(w,{}),e.jsx(ne,{ProdId:o}),e.jsx(w,{}),e.jsx(oe,{Id:o})]}),e.jsx(ee,{ProdId:o})]})]})]})}export{je as default};
