import{m as N,j as e,T as y,b as P,F as M,B as i,r as S,ah as He,a5 as x,a6 as g,a7 as f,o as k,I as B,aE as J,aF as F,t as E,x as I,aG as ve,ac as xe,ad as pe,ae as je,af as q,ag as Ce,L as ge,aH as fe,aI as _,ab as K,D as W,n as V,g as Z,h as ee,i as ne,k as se,aa as Ie,N as re,aB as be,aj as ye,ak as Pe,ao as Ae,O as ke,z as Oe,aJ as Me,aK as Be,c as qe,l as Le,aL as ze,a1 as $e,$ as _e,a0 as Xe,a2 as Qe,a3 as Ye,a8 as we,aM as Je,ar as Ke}from"./vendor-nd_CUwkm.js";import{L as b,a as U,e as w,A as h,F as $,f as G,c as Q,H as L,C as We,G as Ze,M as Ge}from"./index-g5wBm8kU.js";import{O as en,a as nn,H as sn}from"./Columns-QCD_DZcc.js";import{t as rn}from"./toFinite-GMFxiq4g.js";import{L as tn}from"./Lazy-JjY9mDNW.js";import"./isObject-tyZXtoJz.js";function an(n){var s=rn(n),r=s%1;return s===s?r?s-r:s:0}function Re(n){return typeof n=="number"&&n==an(n)}const on=N({body:{...U,alignItems:"flex-start"}}),cn=new b("Admin","Order","Detail","Action");function ln({OrderId:n,Status:s,Refresh:r}){const t=on(),{dispatch:o,dispatchToast:a}=w(cn),{run:c}=h.Order.Post.useAccept({manual:!0,onError(l,u){o({Message:"Failed Accept Order",Request:u,Error:l})},onSuccess(){a(e.jsx(y,{children:e.jsx(P,{children:"Order Accepted"})}),{intent:"success"}),r()}});switch(s){case"Processing":case"Shipping":case"Finished":case"Cancelled":case"Returning":return null}return e.jsx(M,{label:"Action",size:"large",children:e.jsx("div",{className:t.body,children:s==="Pending"&&e.jsx(i,{appearance:"subtle",onClick:()=>c(n),children:"Accept Order"})})})}const dn=N({body:{...$,justifyContent:"space-between"}}),un=new b("Admin","Order","Detail","Append");function mn({OrderId:n,Refresh:s}){const r=dn(),[t,o]=S.useState(),{dispatch:a,dispatchToast:c}=w(un),{run:l}=h.Order.Post.useAppend({manual:!0,onError(j,d){a({Message:"Failed Append Comment",Request:d,Error:j})},onSuccess(){c(e.jsx(y,{children:e.jsx(P,{children:"Comment Appended"})}),{intent:"success"}),s()}}),{run:u}=h.Order.Post.useClose({manual:!0,onError(j,d){a({Message:"Failed Close Order",Request:d,Error:j})},onSuccess(){c(e.jsx(y,{children:e.jsx(P,{children:"Order Closed"})}),{intent:"success"}),s()}});return e.jsxs(e.Fragment,{children:[e.jsx(M,{label:"Append",size:"large",children:e.jsx(He,{value:t,onChange:(j,d)=>o(d.value),maxLength:1e3})}),e.jsxs("div",{className:r.body,children:[e.jsx(i,{onClick:()=>u(n,t),children:"Force Close with Reason"}),e.jsx(i,{appearance:"primary",onClick:()=>l(n,t),children:"Add Comment"})]})]})}const Ne=N({ten:{flexBasis:"10%",flexGrow:0}}),hn=[x({columnId:"Product",renderHeaderCell(){return e.jsx(g,{children:"Name"})},renderCell(n){return e.jsx(f,{children:n.Name})}}),x({columnId:"Type",renderHeaderCell(){return e.jsx(g,{children:"Type"})},renderCell(n){return e.jsx(f,{children:Object.entries(n.Type).reduce((s,r)=>`${s} ${r[0]} : ${r[1]} ;`,"")})}}),x({columnId:"Quantity",renderHeaderCell(){return e.jsx(g,{className:Ne().ten,children:"Quantity"})},renderCell(n){return e.jsx(f,{className:Ne().ten,children:n.Quantity})}})];function xn({Items:n}){return e.jsx(G,{Items:n,Columns:hn})}const pn=new b("Admin","Order","Detail","Shipment");function jn({OrderId:n,TrackingNumber:s,Refresh:r}){const[t,{setTrue:o,setFalse:a}]=k(),[c,l]=S.useState(s),{dispatch:u,dispatchToast:j}=w(pn),{run:d}=h.Order.Post.useShip({manual:!0,onError(C,m){u({Message:"Failed Update Tracking Number",Request:m,Error:C})},onSuccess(){j(e.jsx(y,{children:e.jsx(P,{children:"Tracking Number Updated"})}),{intent:"success"}),a(),r()}});return e.jsx(M,{label:"Shipment",size:"large",children:e.jsx(B,{value:c,disabled:!t,appearance:"underline",onChange:(C,m)=>l(m.value),placeholder:"Fill in this field to ship the order.",contentAfter:t?e.jsx(i,{appearance:"subtle",icon:e.jsx(J,{}),onClick:()=>d(n,c)}):e.jsx(i,{appearance:"subtle",icon:e.jsx(F,{}),onClick:o})})})}const Cn=N({body:{...U,rowGap:E.spacingVerticalXL}}),te=new b("Admin","Order","Detail");function gn({OrderId:n}){const s=Cn(),[r,{setTrue:t,setFalse:o}]=k(),{Nav:a,Paths:c}=Q(),l=parseInt(c.at(2)),{data:u,run:j}=I(()=>h.Order.Get.Detail(n,te),{manual:!0,onError:te.error}),{data:d,run:C}=I(()=>h.Order.Get.Order(n),{onError(p){a("Admin","Order"),te.error(p)},manual:!0});function m(){C(),j()}return S.useEffect(()=>{l===n?(m(),t()):o()},[l]),e.jsxs(e.Fragment,{children:[e.jsx(i,{appearance:"subtle",icon:e.jsx(ve,{}),onClick:()=>a("Admin","Order",n)}),e.jsxs(xe,{open:r,position:"end",size:"medium",modalType:"alert",children:[e.jsx(pe,{children:e.jsx(je,{action:e.jsx(i,{appearance:"subtle",icon:e.jsx(q,{}),onClick:()=>a("Admin","Order")}),children:"Order Detail"})}),e.jsxs(Ce,{className:s.body,children:[e.jsx(en,{OrderId:n,Order:d,Admin:!0}),e.jsx(M,{label:"Required Products",size:"large",children:e.jsx(xn,{Items:u?.ShopCart})}),e.jsx(jn,{OrderId:n,TrackingNumber:d?.TrackingNumber,Refresh:m}),e.jsx(nn,{Comments:u?.Comments}),e.jsx(mn,{OrderId:n,Refresh:m}),e.jsx(ln,{OrderId:n,Status:d?.Status,Refresh:m})]})]})]})}const Y=N({two:{flexBasis:"2.5%",flexGrow:0},twoc:{flexBasis:"2.5%",flexGrow:0,justifyContent:"center"},ten:{flexBasis:"10%",flexGrow:0}}),ie=new b("Admin","Order"),fn=[...sn(ie).slice(0,-1),x({columnId:"User",renderHeaderCell:()=>e.jsx(g,{className:Y().ten,children:"User"}),renderCell(n){return e.jsx(f,{className:Y().ten,children:n.User})}}),x({columnId:"Action",renderHeaderCell:()=>e.jsx(g,{className:Y().two,children:"Action"}),renderCell(n){return e.jsx(f,{className:Y().twoc,children:e.jsx(gn,{OrderId:n.Id})})}})];function bn(){const{data:n}=I(()=>h.Order.Get.List(ie),{onError:ie.error});return e.jsx(G,{Items:n,Columns:fn})}const yn=N({body:{...$,alignItems:"center"},input:{flexGrow:1}}),ae=new b("Admin","Product","Detail","Category");function Pn({ProdId:n}){const[s,r]=S.useState(""),[t,{setTrue:o,setFalse:a}]=k();I(()=>h.Product.Get.Category(n),{onSuccess(A){A&&r(A)},onError:ae.error});const{dispatch:c,dispatchToast:l}=w(ae),{run:u}=h.Product.Patch.useCategory({manual:!0,onError(A,v){c({Message:"Failed Update Category",Request:v,Error:A})},onSuccess(){l(e.jsx(y,{children:e.jsx(P,{children:"Category Updated"})}),{intent:"success"}),a()}}),{run:j}=h.Product.Delete.useCategory({manual:!0,onError(A,v){c({Message:"Failed Detach Category",Request:v,Error:A})},onSuccess(){l(e.jsx(y,{children:e.jsx(P,{children:"Category Detached"})}),{intent:"success"}),a()}}),{data:d}=I(()=>L.Gallery.Get.Categories(),{onSuccess(A){m(A)},onError:ae.error}),[C,m]=S.useState(d),[p,D]=S.useState(""),T=yn();return e.jsxs("div",{className:T.body,children:[e.jsx(ge,{size:"large",disabled:!t,children:"Category"}),e.jsxs(fe,{className:T.input,size:"large",disabled:!t,freeform:!0,placeholder:s||"Pending",appearance:"underline",onChange:A=>{const v=A.target.value.trim(),R=d?.filter(Ue=>Ue.toLowerCase().indexOf(v.toLowerCase())===0);m(R),v&&R&&R.length<1?D(v):D("")},onOptionSelect:(A,v)=>{const R=v.optionText;r(R),R&&d?.includes(R)?D(""):D(R)},children:[p&&e.jsxs(_,{text:p,children:['Create New "',p,'"']},p),C?.map(A=>e.jsx(_,{children:A},A)),C?.length===d?.length?e.jsx(_,{text:"",children:"Pending"},""):null]}),t?e.jsx(i,{appearance:"subtle",icon:e.jsx(J,{}),onClick:()=>{s?u(n,s):j(n)}}):e.jsx(i,{appearance:"subtle",icon:e.jsx(F,{}),onClick:o})]})}const An=new b("Admin","Product","Detail","Combo","Delete");function wn({ComboId:n,Refresh:s}){const{dispatch:r,dispatchToast:t}=w(An),{run:o}=h.Product.Delete.useCombo({manual:!0,onError(a,c){r({Message:"Failed Delete Combo",Request:c,Error:a})},onSuccess(){t(e.jsx(y,{children:e.jsx(P,{children:"Combo Deleted"})}),{intent:"success"}),s()}});return e.jsx(i,{appearance:"subtle",icon:e.jsx(K,{}),onClick:()=>o(n)})}const Nn=[x({columnId:"Variant",renderHeaderCell:()=>e.jsx(g,{children:"Variant"}),renderCell(n){return e.jsx(f,{children:n.Name})}}),x({columnId:"Type",renderHeaderCell:()=>e.jsx(g,{children:"Type"}),renderCell(n){return e.jsx(f,{children:e.jsx(fe,{defaultValue:n.Current,defaultSelectedOptions:[n.Current],onOptionSelect:(s,r)=>n.Update(r.optionValue),children:n.Types.map((s,r)=>e.jsx(_,{children:s},r))})})}})],Sn=N({body:{...$,justifyContent:"flex-end",alignItems:"center",columnGap:E.spacingVerticalM,marginTop:E.spacingHorizontalM}}),oe=new b("Admin","Product","Detail","Combo","Detail");function Dn({Id:n,ProdId:s,Combo:r,Stock:t,Refresh:o}){const[a,{toggle:c}]=k(),[l,u]=S.useState(r),[j,d]=S.useState(t),{data:C}=I(()=>h.Product.Get.Variants(s,oe),{onError:oe.error}),{dispatch:m,dispatchToast:p}=w(oe),{run:D}=h.Product.Patch.useCombo({manual:!0,onError(T,A){m({Message:"Failed Update Combo",Request:A,Error:T})},onSuccess(){p(e.jsx(y,{children:e.jsx(P,{children:"Combo Updated"})}),{intent:"success"}),o(),c()}});return e.jsxs(W,{open:a,onOpenChange:c,children:[e.jsx(V,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(F,{})})}),e.jsx(Z,{children:e.jsxs(ee,{children:[e.jsx(ne,{action:e.jsx(V,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(q,{})})}),children:"Combo Detail"}),e.jsxs(se,{children:[e.jsx(G,{Items:C?.map(T=>({Current:l[T.Name],Update(A){l[T.Name]=A,u({...l})},...T})),Columns:Nn}),e.jsxs("div",{className:Sn().body,children:[e.jsx(ge,{children:"Stock"}),e.jsx(Ie,{value:j,min:0,onChange:(T,A)=>{if(A.value)d(A.value);else if(A.displayValue){const v=parseInt(A.displayValue);Re(v)&&d(v)}}}),e.jsx(i,{appearance:"primary",onClick:()=>D(n,l,j),children:"Submit"})]})]})]})})]})}const En=[x({columnId:"Variant",renderHeaderCell:()=>e.jsx(g,{children:"Variant"}),renderCell(n){return e.jsx(f,{children:n.Name})}}),x({columnId:"Type",renderHeaderCell:()=>e.jsx(g,{children:"Type"}),renderCell(n){return e.jsx(f,{children:e.jsx(fe,{onOptionSelect:(s,r)=>n.Update(r.optionValue),children:n.Types.map((s,r)=>e.jsx(_,{children:s},r))})})}})],Tn=N({body:{...$,justifyContent:"flex-end",alignItems:"center",columnGap:E.spacingVerticalM,marginTop:E.spacingHorizontalM}}),ce=new b("Admin","Product","Detail","Combo","NewCombo");function vn({ProdId:n,Refresh:s}){const[r,{toggle:t}]=k(),[o,a]=S.useState({}),[c,l]=S.useState(1),{data:u}=I(()=>h.Product.Get.Variants(n,ce),{onSuccess(m){for(const p of m)o[p.Name]="";a({...o})},onError:ce.error}),{dispatch:j,dispatchToast:d}=w(ce),{run:C}=h.Product.Post.useCombo({manual:!0,onError(m,p){j({Message:"Failed Create Combo",Request:p,Error:m})},onSuccess(){d(e.jsx(y,{children:e.jsx(P,{children:"Combo Created"})}),{intent:"success"}),s(),t()}});return e.jsxs(W,{open:r,onOpenChange:t,children:[e.jsx(V,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"primary",icon:e.jsx(re,{}),children:"New Combo"})}),e.jsx(Z,{children:e.jsxs(ee,{children:[e.jsx(ne,{action:e.jsx(V,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(q,{})})}),children:"New Combo"}),e.jsxs(se,{children:[e.jsx(G,{Items:u?.map(m=>({Update(p){o[m.Name]=p,a({...o})},...m})),Columns:En}),e.jsxs("div",{className:Tn().body,children:[e.jsx(ge,{children:"Stock"}),e.jsx(Ie,{value:c,min:0,onChange:(m,p)=>{if(p.value)l(p.value);else if(p.displayValue){const D=parseInt(p.displayValue);Re(D)&&l(D)}}}),e.jsx(i,{appearance:"primary",onClick:()=>C(n,o,c),children:"Create"})]})]})]})})]})}const H=N({body:{...$,justifyContent:"space-between"},four:{flexBasis:"4%",flexGrow:0},seven:{flexBasis:"7%",flexGrow:0},five:{flexBasis:"5%",flexGrow:0}}),Se=new b("Admin","Product","Detail","Combo"),In=[x({columnId:"Id",renderHeaderCell:()=>e.jsx(g,{className:H().four,children:"Id"}),renderCell(n){return e.jsx(f,{className:H().four,children:n.Id})}}),x({columnId:"Combo",renderHeaderCell:()=>e.jsx(g,{children:"Combo"}),renderCell(n){return e.jsx(f,{children:Object.entries(n.Combo).reduce((s,r)=>`${s} ${r[0]} : ${r[1]} ;`,"")})}}),x({columnId:"Stock",renderHeaderCell:()=>e.jsx(g,{className:H().five,children:"Stock"}),renderCell(n){return e.jsx(f,{className:H().five,children:n.Stock})}}),x({columnId:"Action",renderHeaderCell:()=>e.jsx(g,{className:H().seven,children:"Action"}),renderCell(n){return e.jsxs(f,{className:H().seven,children:[e.jsx(Dn,{...n}),e.jsx(wn,{ComboId:n.Id,Refresh:n.Refresh})]})}})];function kn({ProdId:n}){const{data:s,run:r}=I(()=>L.Product.Get.Combo(n,Se),{onError:Se.error});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:H().body,children:[e.jsx(be,{children:"Combo"}),e.jsx(vn,{ProdId:n,Refresh:r})]}),e.jsx(G,{Items:s?.map(t=>({ProdId:n,Refresh:r,...t})),Columns:In})]})}const $n=new b("Admin","Product","Detail","Delete"),Gn=N({root:{...U,rowGap:E.spacingHorizontalS}});function Rn({ProdId:n}){const{Nav:s}=Q(),{dispatch:r,dispatchToast:t}=w($n),{run:o,loading:a}=h.Product.Delete.useProduct({manual:!0,onError(l,u){r({Message:"Failed Delete Product",Request:u,Error:l})},onSuccess(){t(e.jsx(y,{children:e.jsx(P,{children:"Product Deleted"})}),{intent:"success"}),s("/Admin")}}),c=Gn();return e.jsx("div",{children:e.jsxs(ye,{withArrow:!0,children:[e.jsx(Pe,{disableButtonEnhancement:!0,children:e.jsx(i,{children:"Delete Product"})}),e.jsxs(Ae,{className:c.root,children:["Are You Sure?",e.jsx(i,{disabled:a,appearance:"primary",onClick:()=>o(n),children:"Yes"})]})]})})}const Vn=N({btn:{...$,columnGap:E.spacingVerticalS},drawer:{width:"1100px"}}),Fn=new b("Admin","Product","Lexical");function Un({ProdId:n}){const s=Vn(),[r,{toggle:t,setTrue:o}]=k(),{data:a,run:c}=I(()=>L.Product.Get.Lexical(n)),{dispatch:l,dispatchToast:u}=w(Fn),{run:j}=h.Product.Post.useLexical({manual:!0,onError(d,C){l({Message:"Failed Update Description",Request:C,Error:d})},onSuccess(){u(e.jsx(y,{children:e.jsx(P,{children:"Description Updated"})}),{intent:"success"}),c(),t()}});return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx(i,{onClick:()=>o(),children:"Open Description Editor"})}),e.jsxs(xe,{open:r,onOpenChange:t,position:"start",size:"large",modalType:"alert",className:s.drawer,children:[e.jsx(pe,{children:e.jsx(je,{action:e.jsxs("div",{className:s.btn,children:[e.jsx(i,{appearance:"primary",onClick:()=>j(n),children:"Save"}),e.jsx(i,{onClick:()=>t(),children:"Cancel"})]}),children:"Edit Product Description"})}),e.jsx(Ce,{children:e.jsx(tn,{State:a?.Description})})]})]})}const De=new b("Admin","Product","Detail","Name");function Hn({ProdId:n}){const[s,r]=S.useState(""),[t,{setTrue:o,setFalse:a}]=k(),{Nav:c}=Q();I(()=>h.Product.Get.Name(n),{onSuccess(d){r(d)},onError(d){c("Admin"),De.error(d)}});const{dispatch:l,dispatchToast:u}=w(De),{run:j}=h.Product.Patch.useName({manual:!0,onError(d,C){l({Message:"Failed Update Name",Request:C,Error:d})},onSuccess(){u(e.jsx(y,{children:e.jsx(P,{children:"Name Updated"})}),{intent:"success"}),a()}});return e.jsx(B,{size:"large",value:s,disabled:!t,appearance:"underline",onChange:(d,C)=>r(C.value),contentBefore:e.jsx(ke,{children:"Name"}),contentAfter:t?e.jsx(i,{appearance:"subtle",icon:e.jsx(J,{}),onClick:()=>j(n,s)}):e.jsx(i,{appearance:"subtle",icon:e.jsx(F,{}),onClick:o})})}const On=N({box:{...$,columnGap:E.spacingHorizontalL},img:{...We,aspectRatio:"1",width:"50%"},cap:{...U,flexGrow:1,rowGap:E.spacingVerticalL}}),le=new b("Admin","Product","Detail","Photo","Edit");function Mn({Id:n,Cover:s,Caption:r,ProductId:t}){const o=On(),[a,c]=S.useState(r||""),{dispatch:l,dispatchToast:u}=w(le),{run:j}=h.Product.Patch.useCaption({manual:!0,onError(m,p){l({Message:"Failed Update Caption",Request:p,Error:m})},onSuccess(){u(e.jsx(y,{children:e.jsx(P,{children:"Caption Updated"})}),{intent:"success"})}}),{run:d}=h.Product.Patch.usePhoto(le,{manual:!0,onBefore([m,p]){u(e.jsx(y,{children:e.jsxs(P,{children:["Uploading Photo ",p.name," for Product ",m," to replace ",n]})}),{intent:"info"})},onError(m,p){l({Message:"Failed Update Photo",Request:p,Error:m})},onSuccess(){u(e.jsx(y,{children:e.jsx(P,{children:"Photo Updated"})}),{intent:"success"})}}),{run:C}=h.Product.Delete.usePhoto({manual:!0,onError(m,p){l({Message:"Failed Delete Photo",Request:p,Error:m})},onSuccess(){u(e.jsx(y,{children:e.jsx(P,{children:"Photo Deleted"})}),{intent:"success"})}});return e.jsxs(W,{children:[e.jsx(V,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(F,{})})}),e.jsx(Z,{children:e.jsxs(ee,{children:[e.jsx(ne,{action:e.jsx(V,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(q,{})})}),children:"Image Detail"}),e.jsxs(se,{className:o.box,children:[e.jsx(Ze,{shape:"rounded",className:o.img,Guid:s,Log:le}),e.jsxs("div",{className:o.cap,children:[e.jsx(M,{label:"Caption",children:e.jsx(B,{value:a,onChange:(m,p)=>c(p.value)})}),e.jsx(i,{onClick:()=>j(n,a),children:"Save Caption"}),e.jsx(i,{onClick:()=>{const m=document.createElement("input");m.type="file",m.accept="image/*",m.onchange=()=>{m.files&&d(n,m.files[0])},m.click()},children:"Replace"}),e.jsx(i,{appearance:"primary",onClick:()=>C(t,n),children:"Delete"})]})]})]})})]})}const de=N({f11:{flexBasis:"11%",flexGrow:0},box:{...$,justifyContent:"space-between"}}),X=new b("Admin","Product","Detail","Photo"),Bn=[Ge(70,X),x({columnId:"Caption",renderHeaderCell:()=>e.jsx(g,{children:"Caption"}),renderCell(n){return e.jsx(f,{children:n.Caption})}}),x({columnId:"Action",renderHeaderCell:()=>e.jsx(g,{className:de().f11,children:"Action"}),renderCell(n){const{dispatch:s}=w(X),{run:r}=h.Product.Post.useMovePhoto({manual:!0,onError(t,o){s({Message:"Failed Update Order",Request:o,Error:t})},onSuccess:qn});return e.jsxs(f,{className:de().f11,children:[e.jsx(i,{appearance:"subtle",icon:e.jsx(Me,{}),onClick:()=>r(n.Id,!0)}),e.jsx(i,{appearance:"subtle",icon:e.jsx(Be,{}),onClick:()=>r(n.Id,!1)}),e.jsx(Mn,{...n})]})}})];let qn=()=>{};function Ln({ProdId:n}){const s=Oe(async()=>{const[a]=await L.Product.Get.PhotoList(n,X);return a.map(l=>({Id:l.PhotoId,Cover:l.ObjectId,Caption:l.Caption||"No Caption",ProductId:l.ProductId}))}),{dispatch:r,dispatchToast:t}=w(X),{run:o}=h.Product.Post.usePhoto(X,{manual:!0,onBefore([a,c]){t(e.jsx(y,{children:e.jsxs(P,{children:["Uploading Photo ",c.name," for Product ",a]})}),{intent:"info"})},onError(a,c){r({Message:"Failed Upload Photo",Request:c,Error:a})},onSuccess(){t(e.jsx(y,{children:e.jsx(P,{children:"Photo Uploaded"})}),{intent:"success"})}});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:de().box,children:[e.jsx(be,{children:"Photos"}),e.jsx(i,{appearance:"primary",icon:e.jsx(re,{}),onClick:()=>{const a=document.createElement("input");a.type="file",a.accept="image/*",a.onchange=()=>{a.files&&o(n,a.files[0])},a.click()},children:"New Image"})]}),e.jsx(G,{Items:s,Columns:Bn})]})}const zn=new b("Admin","Product","Detail","Variant","Delete");function _n({VariantId:n,Refresh:s}){const{dispatch:r,dispatchToast:t}=w(zn),{run:o}=h.Product.Delete.useVariant({manual:!0,onError(a,c){r({Message:"Failed Delete Variant",Request:c,Error:a})},onSuccess(){t(e.jsx(y,{children:e.jsx(P,{children:"Variant Deleted"})}),{intent:"success"}),s()}});return e.jsx(i,{appearance:"subtle",icon:e.jsx(K,{}),onClick:()=>o(n)})}const Xn=new b("Admin","Product","Detail","Variant","Edit","TypeDelete");function Qn({VariantId:n,Type:s,Refresh:r}){const{dispatch:t,dispatchToast:o}=w(Xn),{run:a}=h.Product.Delete.useType({manual:!0,onError(c,l){t({Message:"Failed Delete Type",Request:l,Error:c})},onSuccess(){o(e.jsx(y,{children:e.jsx(P,{children:"Type Deleted"})}),{intent:"success"}),r()}});return e.jsx(i,{appearance:"subtle",icon:e.jsx(K,{}),onClick:()=>a(n,s)})}const Yn=new b("Admin","Product","Detail","Variant","Edit","Name");function Jn({Id:n,Name:s}){const[r,t]=S.useState(s),[o,{setTrue:a,setFalse:c}]=k(),{dispatch:l,dispatchToast:u}=w(Yn),{run:j}=h.Product.Patch.useVariantName({manual:!0,onError(d,C){l({Message:"Failed Update Variant Name",Request:C[0],Error:d})},onSuccess(){u(e.jsx(y,{children:e.jsx(P,{children:"Variant Name Updated"})}),{intent:"success"}),c()}});return e.jsx(B,{size:"large",value:r,disabled:!o,appearance:"underline",onChange:(d,C)=>t(C.value),contentBefore:e.jsx(ke,{children:"Name"}),contentAfter:o?e.jsx(i,{appearance:"subtle",icon:e.jsx(J,{}),onClick:()=>j(n,r)}):e.jsx(i,{appearance:"subtle",icon:e.jsx(F,{}),onClick:a})})}const Kn=N({body:{...U,rowGap:E.spacingVerticalM}}),Wn=new b("Admin","Product","Detail","Variant","Edit","Type");function Ve({VariantId:n,Type:s,Refresh:r,New:t}){const o=Kn(),[a,{toggle:c}]=k(),[l,u]=S.useState(s||""),{dispatch:j,dispatchToast:d}=w(Wn),C={manual:!0,onError(D,T){j({Message:`Failed ${t?"Create":"Update"} Type ${l}`,Request:T,Error:D})},onSuccess(D){d(e.jsxs(y,{children:[e.jsxs(P,{children:["Type ",t?"Created":"Updated"]}),e.jsxs(qe,{children:[D," ",l]})]}),{intent:"success"}),r(),u(""),c()}},{run:m}=h.Product.Post.useType(C),{run:p}=h.Product.Patch.useType(C);return e.jsxs(ye,{withArrow:!0,open:a,onOpenChange:c,children:[e.jsx(Pe,{disableButtonEnhancement:!0,children:t?e.jsx(i,{icon:e.jsx(re,{}),appearance:"primary",children:"New Type"}):e.jsx(i,{appearance:"subtle",icon:e.jsx(F,{})})}),e.jsxs(Ae,{className:o.body,children:[e.jsx(M,{label:"Type Name",children:e.jsx(B,{value:l,onChange:(D,T)=>u(T.value)})}),e.jsx(i,{onClick:()=>t?m(n,l):p(n,s,l),children:"Submit"})]})]})}const ue=N({body:{...U,rowGap:E.spacingVerticalM},twelve:{flexBasis:"12%",flexGrow:0}}),Zn=[x({columnId:"Name",renderHeaderCell:()=>e.jsx(g,{children:"Name"}),renderCell(n){return e.jsx(f,{children:n.Name})}}),x({columnId:"Action",renderHeaderCell:()=>e.jsx(g,{className:ue().twelve,children:"Action"}),renderCell(n){return e.jsxs(f,{className:ue().twelve,children:[e.jsx(Ve,{VariantId:n.VariantId,Type:n.Name,Refresh:n.Refresh}),e.jsx(Qn,{VariantId:n.VariantId,Type:n.Name,Refresh:n.Refresh})]})}})];function es({Variant:n,Refresh:s}){return e.jsxs(W,{children:[e.jsx(V,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(F,{})})}),e.jsx(Z,{children:e.jsxs(ee,{children:[e.jsx(ne,{action:e.jsx(V,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(q,{})})}),children:"Variant Detail"}),e.jsxs(se,{className:ue().body,children:[e.jsx(Jn,{Id:n.Id,Name:n.Name}),e.jsx(G,{Items:n.Types.map((r,t)=>({Id:t,Name:r,VariantId:n.Id,Refresh:s})),Columns:Zn})]}),e.jsx(Le,{children:e.jsx(Ve,{VariantId:n.Id,Refresh:s,New:!0})})]})})]})}const ns=N({body:{...U,rowGap:E.spacingVerticalM}}),ss=new b("Admin","Product","Detail","Variant","New");function rs({ProdId:n,Refresh:s}){const r=ns(),[t,{toggle:o}]=k(),[a,c]=S.useState(""),{dispatch:l,dispatchToast:u}=w(ss),{run:j}=h.Product.Post.useVariant({manual:!0,onError(d,C){l({Message:"Failed Create Variant",Request:C,Error:d})},onSuccess(){u(e.jsx(y,{children:e.jsx(P,{children:"Variant Created"})}),{intent:"success"}),s(),c(""),o()}});return e.jsxs(ye,{withArrow:!0,open:t,onOpenChange:o,children:[e.jsx(Pe,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"primary",icon:e.jsx(re,{}),children:"New Variant"})}),e.jsxs(Ae,{className:r.body,children:[e.jsx(M,{required:!0,label:"Variant Name",children:e.jsx(B,{value:a,onChange:(d,C)=>c(C.value)})}),e.jsx(i,{onClick:()=>j(n,a),children:"Add"})]})]})}const O=N({body:{...$,justifyContent:"space-between"},four:{flexBasis:"4%",flexGrow:0},seven:{flexBasis:"7%",flexGrow:0},twelve:{flexBasis:"12%",flexGrow:0}}),Ee=new b("Admin","Product","Detail","Variant"),ts=[x({columnId:"Id",renderHeaderCell:()=>e.jsx(g,{className:O().four,children:"Id"}),renderCell(n){return e.jsx(f,{className:O().four,children:n.Id})}}),x({columnId:"Name",renderHeaderCell:()=>e.jsx(g,{className:O().twelve,children:"Name"}),renderCell(n){return e.jsx(f,{className:O().twelve,children:n.Name})}}),x({columnId:"Type",renderHeaderCell:()=>e.jsx(g,{children:"Type"}),renderCell(n){return e.jsx(f,{children:n.Types.reduce((s,r)=>`${s} ${r} ;`,"")})}}),x({columnId:"Action",renderHeaderCell:()=>e.jsx(g,{className:O().seven,children:"Action"}),renderCell(n){return e.jsxs(f,{className:O().seven,children:[e.jsx(es,{Variant:n,Refresh:me}),e.jsx(_n,{VariantId:n.Id,Refresh:me})]})}})];let me;function as({ProdId:n}){const s=O(),{data:r,run:t}=I(()=>h.Product.Get.Variants(n,Ee),{onError:Ee.error});return me=t,e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:s.body,children:[e.jsx(be,{children:"Variant"}),e.jsx(rs,{ProdId:n,Refresh:t})]}),e.jsx(G,{Items:r,Columns:ts})]})}const os=N({body:{...U,rowGap:E.spacingVerticalXL,paddingBottom:E.spacingVerticalXXXL}});function cs({ProdId:n}){const s=os(),[r,{setFalse:t,setTrue:o}]=k(),{Nav:a,Paths:c}=Q(),l=parseInt(c.at(1));return S.useEffect(()=>{l===n?o():t()},[c]),e.jsxs(e.Fragment,{children:[e.jsx(i,{appearance:"subtle",icon:e.jsx(ve,{}),onClick:()=>{a("Admin",n),o()}}),e.jsxs(xe,{open:r,position:"end",size:"large",modalType:"alert",children:[e.jsx(pe,{children:e.jsx(je,{action:e.jsx(i,{appearance:"subtle",icon:e.jsx(q,{}),onClick:()=>{a("Admin"),t()}}),children:"Product Detail"})}),e.jsxs(Ce,{className:s.body,children:[e.jsx(Hn,{ProdId:n}),e.jsx(Pn,{ProdId:n}),e.jsx(Ln,{ProdId:n}),e.jsx(as,{ProdId:n}),e.jsx(kn,{ProdId:n}),e.jsx(Un,{ProdId:n}),e.jsx(Rn,{ProdId:n})]})]})]})}const z=new b("Admin","Product","Row");function ls({item:n}){const[s,r]=S.useState(()=>({Id:n,Cover:"",Name:"Loading..."})),[t,{setTrue:o}]=k(),a=L.Product.Get;return ze(async()=>{const c=await a.Product(n).catch(z.error);if(!c)return z.warn(`Product ${n} Not Found`),o();let l={...s,Name:c.Name,Category:c.Category||"Pending"};r(l);const[u,j]=await a.PhotoList(n,z);j||z.warn(`Product ${n} has no photo`),r(l={...l,Cover:j});const d=await h.Product.Get.Count(n).catch(z.error);d&&r({...l,...d})},[]),t?null:e.jsx($e,{children:({renderCell:c})=>c(s)},n)}const Te=N({two:{flexBasis:"2.5%",flexGrow:0},twoc:{flexBasis:"2.5%",flexGrow:0,justifyContent:"center"}}),Fe=new b("Admin","Product"),is=[Ge(50,Fe),x({columnId:"Product",renderHeaderCell:()=>e.jsx(g,{children:"Product"}),renderCell(n){return e.jsx(f,{children:e.jsx(we,{children:n.Name})})}}),x({columnId:"Category",renderHeaderCell:()=>e.jsx(g,{children:"Category"}),renderCell(n){return e.jsx(f,{children:e.jsx(we,{children:n.Category})})}}),x({columnId:"Variant",renderHeaderCell:()=>e.jsx(g,{children:"Variant"}),renderCell(n){return e.jsx(f,{children:n.Variant})}}),x({columnId:"Combo",renderHeaderCell:()=>e.jsx(g,{children:"Combo"}),renderCell(n){return e.jsx(f,{children:n.Combo})}}),x({columnId:"Stock",renderHeaderCell:()=>e.jsx(g,{children:"Stock"}),renderCell(n){return e.jsx(f,{children:n.Stock})}}),x({columnId:"Action",renderHeaderCell:()=>e.jsx(g,{className:Te().two,children:"Detail"}),renderCell(n){return e.jsx(f,{className:Te().twoc,children:e.jsx(cs,{ProdId:n.Id})})}})];function ds(){const n=h.Product.Get.useList(Fe);return e.jsxs(_e,{items:n?n.reverse():[],columns:is,children:[e.jsx(Xe,{children:e.jsx($e,{children:({renderHeaderCell:s})=>s()})}),e.jsx(Qe,{children:s=>e.jsx(ls,{...s})}),!n&&e.jsx(Ye,{size:48})]})}const us=new b("Admin","User","Delete");function ms({UserId:n,Refresh:s}){const{dispatch:r,dispatchToast:t}=w(us),{run:o}=h.User.Delete.useUser({manual:!0,onError(a,c){r({Message:"Failed Delete User",Request:c,Error:a})},onSuccess(){t(e.jsx(y,{children:e.jsx(P,{children:"User Deleted"})}),{intent:"success"}),s()}});return e.jsx(i,{appearance:"subtle",icon:e.jsx(K,{}),onClick:()=>o(n)})}const hs=new b("Admin","User","Grant");function xs({UserId:n,Admin:s,Refresh:r}){const{dispatch:t,dispatchToast:o}=w(hs),{run:a}=h.User.Post.useAdmin({manual:!0,onError(l,u){t({Message:"Failed Grant Admin",Request:u,Error:l})},onSuccess(){o(e.jsx(y,{children:e.jsx(P,{children:"Admin Granted"})}),{intent:"success"}),r()}}),{run:c}=h.User.Delete.useAdmin({manual:!0,onError(l,u){t({Message:"Failed Revoke Admin",Request:u,Error:l})},onSuccess(){o(e.jsx(y,{children:e.jsx(P,{children:"Admin Revoked"})}),{intent:"success"}),r()}});return e.jsx(Je,{checked:s,onChange:(l,u)=>{u.checked?a(n):c(n)}})}const ps=new b("Admin","User"),js=[x({columnId:"Id",renderHeaderCell:()=>"Id",renderCell(n){return n.Id}}),x({columnId:"Name",renderHeaderCell:()=>"Real Name",renderCell(n){return n.Name}}),x({columnId:"Email",renderHeaderCell:()=>"E-Mail",renderCell(n){return n.EMail}}),x({columnId:"Admin",renderHeaderCell:()=>"Admin",renderCell(n){return e.jsx(xs,{UserId:n.Id,Admin:n.Admin,Refresh:he})}}),x({columnId:"Delete",renderHeaderCell:()=>"Delete",renderCell(n){return e.jsx(ms,{UserId:n.Id,Refresh:he})}})].map(({renderHeaderCell:n,renderCell:s,...r})=>({...r,renderHeaderCell:()=>e.jsx(g,{children:n()}),renderCell:t=>e.jsx(f,{children:s(t)})}));let he;function Cs(){const{data:n,run:s}=I(()=>h.User.Get.List(),{onError:ps.error});return he=s,e.jsx(G,{Items:n,Columns:js})}const gs=new b("Admin");function Ns(){const{Paths:n,Nav:s}=Q(),r=n.at(1),t=S.useMemo(()=>{switch(r){case"Order":return e.jsx(bn,{});case"User":return e.jsx(Cs,{});default:return e.jsx(ds,{})}},[r]),o=L.User.Get.useMe(gs);return o?o.Admin?t:s("/"):e.jsx(Ke,{size:"huge",label:"Authenticating..."})}export{Ns as default};
