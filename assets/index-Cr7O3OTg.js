import{m as w,j as e,T as A,b as P,F as H,B as i,r as S,ag as Ue,a4 as h,a5 as g,a6 as f,o as k,I as B,aD as K,aE as V,t as T,x as E,aF as Ee,ab as he,ac as je,ad as pe,ae as q,af as Ce,L as ge,aG as fe,aH as X,aa as J,D as W,n as R,g as Y,h as Z,i as ee,k as ne,a9 as Te,K as re,az as be,N as ve,aI as He,aJ as Oe,ai as Ie,aj as ke,an as $e,c as Me,l as Be,a7 as ye,$ as qe,a0 as Le,a1 as Ae,a2 as ze,aK as _e,aq as Xe}from"./vendor-4drOEEjM.js";import{L as b,a as O,e as N,A as x,F as $,f as G,c as L,H as z,C as Qe,G as Ke,M as Ge}from"./index-z76kN4xN.js";import{O as Je,a as We,H as Ye}from"./Columns-T6r7GHMv.js";import{t as Ze}from"./toFinite-GMFxiq4g.js";import{L as en}from"./Lazy-l3ytWyaZ.js";import"./isObject-tyZXtoJz.js";function nn(n){var r=Ze(n),s=r%1;return r===r?s?r-s:r:0}function Re(n){return typeof n=="number"&&n==nn(n)}const rn=w({body:{...O,alignItems:"flex-start"}}),sn=new b("Admin","Order","Detail","Action");function tn({OrderId:n,Status:r,Refresh:s}){const t=rn(),{dispatch:a,dispatchToast:o}=N(sn),{run:c}=x.Order.Post.useAccept({manual:!0,onError(l,m){a({Message:"Failed Accept Order",Request:m,Error:l})},onSuccess(){o(e.jsx(A,{children:e.jsx(P,{children:"Order Accepted"})}),{intent:"success"}),s()}});switch(r){case"Processing":case"Shipping":case"Finished":case"Cancelled":case"Returning":return null}return e.jsx(H,{label:"Action",size:"large",children:e.jsx("div",{className:t.body,children:r==="Pending"&&e.jsx(i,{appearance:"subtle",onClick:()=>c(n),children:"Accept Order"})})})}const an=w({body:{...$,justifyContent:"space-between"}}),cn=new b("Admin","Order","Detail","Append");function on({OrderId:n,Refresh:r}){const s=an(),[t,a]=S.useState(),{dispatch:o,dispatchToast:c}=N(cn),{run:l}=x.Order.Post.useAppend({manual:!0,onError(p,u){o({Message:"Failed Append Comment",Request:u,Error:p})},onSuccess(){c(e.jsx(A,{children:e.jsx(P,{children:"Comment Appended"})}),{intent:"success"}),r()}}),{run:m}=x.Order.Post.useClose({manual:!0,onError(p,u){o({Message:"Failed Close Order",Request:u,Error:p})},onSuccess(){c(e.jsx(A,{children:e.jsx(P,{children:"Order Closed"})}),{intent:"success"}),r()}});return e.jsxs(e.Fragment,{children:[e.jsx(H,{label:"Append",size:"large",children:e.jsx(Ue,{value:t,onChange:(p,u)=>a(u.value),maxLength:1e3})}),e.jsxs("div",{className:s.body,children:[e.jsx(i,{onClick:()=>m(n,t),children:"Force Close with Reason"}),e.jsx(i,{appearance:"primary",onClick:()=>l(n,t),children:"Add Comment"})]})]})}const Pe=w({ten:{flexBasis:"10%",flexGrow:0}}),ln=[h({columnId:"Product",renderHeaderCell(){return e.jsx(g,{children:"Name"})},renderCell(n){return e.jsx(f,{children:n.Name})}}),h({columnId:"Type",renderHeaderCell(){return e.jsx(g,{children:"Type"})},renderCell(n){return e.jsx(f,{children:Object.entries(n.Type).reduce((r,s)=>`${r} ${s[0]} : ${s[1]} ;`,"")})}}),h({columnId:"Quantity",renderHeaderCell(){return e.jsx(g,{className:Pe().ten,children:"Quantity"})},renderCell(n){return e.jsx(f,{className:Pe().ten,children:n.Quantity})}})];function dn({Items:n}){return e.jsx(G,{Items:n||[],Columns:ln})}const un=new b("Admin","Order","Detail","Shipment");function mn({OrderId:n,TrackingNumber:r,Refresh:s}){const[t,{setTrue:a,setFalse:o}]=k(),[c,l]=S.useState(r),{dispatch:m,dispatchToast:p}=N(un),{run:u}=x.Order.Post.useShip({manual:!0,onError(j,d){m({Message:"Failed Update Tracking Number",Request:d,Error:j})},onSuccess(){p(e.jsx(A,{children:e.jsx(P,{children:"Tracking Number Updated"})}),{intent:"success"}),o(),s()}});return e.jsx(H,{label:"Shipment",size:"large",children:e.jsx(B,{value:c,disabled:!t,appearance:"underline",onChange:(j,d)=>l(d.value),placeholder:"Fill in this field to ship the order.",contentAfter:t?e.jsx(i,{appearance:"subtle",icon:e.jsx(K,{}),onClick:()=>u(n,c)}):e.jsx(i,{appearance:"subtle",icon:e.jsx(V,{}),onClick:a})})})}const xn=w({body:{...O,rowGap:T.spacingVerticalXL}}),se=new b("Admin","Order","Detail");function hn({OrderId:n}){const r=xn(),[s,{setTrue:t,setFalse:a}]=k(),{Nav:o,Paths:c}=L(),l=parseInt(c.at(2)),{data:m,run:p}=E(()=>x.Order.Get.Detail(n,se),{manual:!0,onError:se.error}),{data:u,run:j}=E(()=>x.Order.Get.Order(n),{onError(C){o("Admin","Order"),se.error(C)},manual:!0});function d(){j(),p()}return S.useEffect(()=>{l===n?(d(),t()):a()},[l]),e.jsxs(e.Fragment,{children:[e.jsx(i,{appearance:"subtle",icon:e.jsx(Ee,{}),onClick:()=>o("Admin","Order",n)}),e.jsxs(he,{open:s,position:"end",size:"medium",modalType:"alert",children:[e.jsx(je,{children:e.jsx(pe,{action:e.jsx(i,{appearance:"subtle",icon:e.jsx(q,{}),onClick:()=>o("Admin","Order")}),children:"Order Detail"})}),e.jsxs(Ce,{className:r.body,children:[e.jsx(Je,{OrderId:n,Order:u,Admin:!0}),e.jsx(H,{label:"Required Products",size:"large",children:e.jsx(dn,{Items:m?.ShopCart})}),e.jsx(mn,{OrderId:n,TrackingNumber:u?.TrackingNumber,Refresh:d}),e.jsx(We,{Comments:m?.Comments}),e.jsx(on,{OrderId:n,Refresh:d}),e.jsx(tn,{OrderId:n,Status:u?.Status,Refresh:d})]})]})]})}const _=w({two:{flexBasis:"2.5%",flexGrow:0},twoc:{flexBasis:"2.5%",flexGrow:0,justifyContent:"center"},ten:{flexBasis:"10%",flexGrow:0}}),le=new b("Admin","Order"),jn=[...Ye(le).slice(0,-1),h({columnId:"User",renderHeaderCell:()=>e.jsx(g,{className:_().ten,children:"User"}),renderCell(n){return e.jsx(f,{className:_().ten,children:n.User})}}),h({columnId:"Action",renderHeaderCell:()=>e.jsx(g,{className:_().two,children:"Action"}),renderCell(n){return e.jsx(f,{className:_().twoc,children:e.jsx(hn,{OrderId:n.Id})})}})];function pn(){const{data:n}=E(()=>x.Order.Get.List(le),{onError:le.error});return e.jsx(G,{Items:n||[],Columns:jn})}const Cn=w({body:{...$,alignItems:"center"},input:{flexGrow:1}}),te=new b("Admin","Product","Detail","Category");function gn({ProdId:n}){const[r,s]=S.useState(""),[t,{setTrue:a,setFalse:o}]=k();E(()=>x.Product.Get.Category(n),{onSuccess(y){y&&s(y)},onError:te.error});const{dispatch:c,dispatchToast:l}=N(te),{run:m}=x.Product.Patch.useCategory({manual:!0,onError(y,D){c({Message:"Failed Update Category",Request:D,Error:y})},onSuccess(){l(e.jsx(A,{children:e.jsx(P,{children:"Category Updated"})}),{intent:"success"}),o()}}),{data:p}=E(()=>z.Gallery.Get.Categories(),{onSuccess(y){j(y)},onError:te.error}),[u,j]=S.useState(p),[d,C]=S.useState(""),v=Cn();return e.jsxs("div",{className:v.body,children:[e.jsx(ge,{size:"large",disabled:!t,children:"Category"}),e.jsxs(fe,{className:v.input,size:"large",disabled:!t,freeform:!0,placeholder:r||"Pending",appearance:"underline",onChange:y=>{const D=y.target.value.trim(),I=p?.filter(Fe=>Fe.toLowerCase().indexOf(D.toLowerCase())===0);j(I),D&&I&&I.length<1?C(D):C("")},onOptionSelect:(y,D)=>{const I=D.optionText;s(I),I&&p?.includes(I)?C(""):C(I)},children:[d&&e.jsxs(X,{text:d,children:['Create New "',d,'"']},d),u?.map(y=>e.jsx(X,{children:y},y))]}),t?e.jsx(i,{appearance:"subtle",icon:e.jsx(K,{}),onClick:()=>r&&m(n,r)}):e.jsx(i,{appearance:"subtle",icon:e.jsx(V,{}),onClick:a})]})}const fn=new b("Admin","Product","Detail","Combo","Delete");function bn({ComboId:n,Refresh:r}){const{dispatch:s,dispatchToast:t}=N(fn),{run:a}=x.Product.Delete.useCombo({manual:!0,onError(o,c){s({Message:"Failed Delete Combo",Request:c,Error:o})},onSuccess(){t(e.jsx(A,{children:e.jsx(P,{children:"Combo Deleted"})}),{intent:"success"}),r()}});return e.jsx(i,{appearance:"subtle",icon:e.jsx(J,{}),onClick:()=>a(n)})}const yn=[h({columnId:"Variant",renderHeaderCell:()=>e.jsx(g,{children:"Variant"}),renderCell(n){return e.jsx(f,{children:n.Name})}}),h({columnId:"Type",renderHeaderCell:()=>e.jsx(g,{children:"Type"}),renderCell(n){return e.jsx(f,{children:e.jsx(fe,{defaultValue:n.Current,defaultSelectedOptions:[n.Current],onOptionSelect:(r,s)=>n.Update(s.optionValue),children:n.Types.map((r,s)=>e.jsx(X,{children:r},s))})})}})],An=w({body:{...$,justifyContent:"flex-end",alignItems:"center",columnGap:T.spacingVerticalM,marginTop:T.spacingHorizontalM}}),ae=new b("Admin","Product","Detail","Combo","Detail");function Pn({Id:n,ProdId:r,Combo:s,Stock:t,Refresh:a}){const[o,{toggle:c}]=k(),[l,m]=S.useState(s),[p,u]=S.useState(t),{data:j}=E(()=>x.Product.Get.Variants(r,ae),{onError:ae.error}),{dispatch:d,dispatchToast:C}=N(ae),{run:v}=x.Product.Patch.useCombo({manual:!0,onError(y,D){d({Message:"Failed Update Combo",Request:D,Error:y})},onSuccess(){C(e.jsx(A,{children:e.jsx(P,{children:"Combo Updated"})}),{intent:"success"}),a(),c()}});return e.jsxs(W,{open:o,onOpenChange:c,children:[e.jsx(R,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(V,{})})}),e.jsx(Y,{children:e.jsxs(Z,{children:[e.jsx(ee,{action:e.jsx(R,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(q,{})})}),children:"Combo Detail"}),e.jsxs(ne,{children:[e.jsx(G,{Items:j?.map(y=>({Current:l[y.Name],Update(D){l[y.Name]=D,m({...l})},...y}))||[],Columns:yn}),e.jsxs("div",{className:An().body,children:[e.jsx(ge,{children:"Stock"}),e.jsx(Te,{value:p,min:0,onChange:(y,D)=>{if(D.value)u(D.value);else if(D.displayValue){const I=parseInt(D.displayValue);Re(I)&&u(I)}}}),e.jsx(i,{appearance:"primary",onClick:()=>v(n,l,p),children:"Submit"})]})]})]})})]})}const Nn=[h({columnId:"Variant",renderHeaderCell:()=>e.jsx(g,{children:"Variant"}),renderCell(n){return e.jsx(f,{children:n.Name})}}),h({columnId:"Type",renderHeaderCell:()=>e.jsx(g,{children:"Type"}),renderCell(n){return e.jsx(f,{children:e.jsx(fe,{onOptionSelect:(r,s)=>n.Update(s.optionValue),children:n.Types.map((r,s)=>e.jsx(X,{children:r},s))})})}})],wn=w({body:{...$,justifyContent:"flex-end",alignItems:"center",columnGap:T.spacingVerticalM,marginTop:T.spacingHorizontalM}}),ce=new b("Admin","Product","Detail","Combo","NewCombo");function Sn({ProdId:n,Refresh:r}){const[s,{toggle:t}]=k(),[a,o]=S.useState({}),[c,l]=S.useState(1),{data:m}=E(()=>x.Product.Get.Variants(n,ce),{onSuccess(d){for(const C of d)a[C.Name]="";o({...a})},onError:ce.error}),{dispatch:p,dispatchToast:u}=N(ce),{run:j}=x.Product.Post.useCombo({manual:!0,onError(d,C){p({Message:"Failed Create Combo",Request:C,Error:d})},onSuccess(){u(e.jsx(A,{children:e.jsx(P,{children:"Combo Created"})}),{intent:"success"}),r(),t()}});return e.jsxs(W,{open:s,onOpenChange:t,children:[e.jsx(R,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"primary",icon:e.jsx(re,{}),children:"New Combo"})}),e.jsx(Y,{children:e.jsxs(Z,{children:[e.jsx(ee,{action:e.jsx(R,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(q,{})})}),children:"New Combo"}),e.jsxs(ne,{children:[e.jsx(G,{Items:m?.map(d=>({Update(C){a[d.Name]=C,o({...a})},...d}))||[],Columns:Nn}),e.jsxs("div",{className:wn().body,children:[e.jsx(ge,{children:"Stock"}),e.jsx(Te,{value:c,min:0,onChange:(d,C)=>{if(C.value)l(C.value);else if(C.displayValue){const v=parseInt(C.displayValue);Re(v)&&l(v)}}}),e.jsx(i,{appearance:"primary",onClick:()=>j(n,a,c),children:"Create"})]})]})]})})]})}const F=w({body:{...$,justifyContent:"space-between"},four:{flexBasis:"4%",flexGrow:0},seven:{flexBasis:"7%",flexGrow:0},five:{flexBasis:"5%",flexGrow:0}}),Ne=new b("Admin","Product","Detail","Combo"),Dn=[h({columnId:"Id",renderHeaderCell:()=>e.jsx(g,{className:F().four,children:"Id"}),renderCell(n){return e.jsx(f,{className:F().four,children:n.Id})}}),h({columnId:"Combo",renderHeaderCell:()=>e.jsx(g,{children:"Combo"}),renderCell(n){return e.jsx(f,{children:Object.entries(n.Combo).reduce((r,s)=>`${r} ${s[0]} : ${s[1]} ;`,"")})}}),h({columnId:"Stock",renderHeaderCell:()=>e.jsx(g,{className:F().five,children:"Stock"}),renderCell(n){return e.jsx(f,{className:F().five,children:n.Stock})}}),h({columnId:"Action",renderHeaderCell:()=>e.jsx(g,{className:F().seven,children:"Action"}),renderCell(n){return e.jsxs(f,{className:F().seven,children:[e.jsx(Pn,{...n}),e.jsx(bn,{ComboId:n.Id,Refresh:n.Refresh})]})}})];function En({ProdId:n}){const{data:r,run:s}=E(()=>z.Product.Get.Combo(n,Ne),{onError:Ne.error});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:F().body,children:[e.jsx(be,{children:"Combo"}),e.jsx(Sn,{ProdId:n,Refresh:s})]}),e.jsx(G,{Items:r?.map(t=>({ProdId:n,Refresh:s,...t}))||[],Columns:Dn})]})}const Tn=new b("Admin","Product","Detail","Delete");function vn({ProdId:n}){const{Nav:r}=L(),{dispatch:s,dispatchToast:t}=N(Tn),{run:a}=x.Product.Delete.useProduct({manual:!0,onError(o,c){s({Message:"Failed Delete Product",Request:c,Error:o})},onSuccess(){t(e.jsx(A,{children:e.jsx(P,{children:"Product Deleted"})}),{intent:"success"}),r("/Admin"),location.reload()}});return e.jsx("div",{children:e.jsx(i,{onClick:()=>a(n),children:"Delete Product"})})}const In=w({btn:{...$,columnGap:T.spacingVerticalS},drawer:{width:"1100px"}}),kn=new b("Admin","Product","Lexical");function $n({ProdId:n}){const r=In(),[s,{toggle:t,setTrue:a}]=k(),{data:o,run:c}=E(()=>z.Product.Get.Lexical(n)),{dispatch:l,dispatchToast:m}=N(kn),{run:p}=x.Product.Post.useDescription({manual:!0,onError(u,j){l({Message:"Failed Update Description",Request:j,Error:u})},onSuccess(){m(e.jsx(A,{children:e.jsx(P,{children:"Description Updated"})}),{intent:"success"}),c(),t()}});return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx(i,{onClick:()=>a(),children:"Open Description Editor"})}),e.jsxs(he,{open:s,onOpenChange:t,position:"start",size:"large",modalType:"alert",className:r.drawer,children:[e.jsx(je,{children:e.jsx(pe,{action:e.jsxs("div",{className:r.btn,children:[e.jsx(i,{appearance:"primary",onClick:()=>p(n),children:"Save"}),e.jsx(i,{onClick:()=>t(),children:"Cancel"})]}),children:"Edit Product Description"})}),e.jsx(Ce,{children:e.jsx(en,{State:o})})]})]})}const we=new b("Admin","Product","Detail","Name");function Gn({ProdId:n}){const[r,s]=S.useState(""),[t,{setTrue:a,setFalse:o}]=k(),{Nav:c}=L();E(()=>x.Product.Get.Name(n),{onSuccess(u){s(u)},onError(u){c("Admin"),we.error(u)}});const{dispatch:l,dispatchToast:m}=N(we),{run:p}=x.Product.Patch.useName({manual:!0,onError(u,j){l({Message:"Failed Update Name",Request:j,Error:u})},onSuccess(){m(e.jsx(A,{children:e.jsx(P,{children:"Name Updated"})}),{intent:"success"}),o()}});return e.jsx(B,{size:"large",value:r,disabled:!t,appearance:"underline",onChange:(u,j)=>s(j.value),contentBefore:e.jsx(ve,{children:"Name"}),contentAfter:t?e.jsx(i,{appearance:"subtle",icon:e.jsx(K,{}),onClick:()=>p(n,r)}):e.jsx(i,{appearance:"subtle",icon:e.jsx(V,{}),onClick:a})})}const Rn=w({box:{...$,columnGap:T.spacingHorizontalL},img:{...Qe,aspectRatio:"1",width:"50%"},cap:{...O,flexGrow:1,rowGap:T.spacingVerticalL}}),oe=new b("Admin","Product","Detail","Photo","Edit");function Vn({Photo:{Id:n,Cover:r,Caption:s},Refresh:t}){const a=Rn(),[o,c]=S.useState(s||""),{dispatch:l,dispatchToast:m}=N(oe),{run:p}=x.Product.Patch.useCaption({manual:!0,onError(d,C){l({Message:"Failed Update Caption",Request:C,Error:d})},onSuccess(){m(e.jsx(A,{children:e.jsx(P,{children:"Caption Updated"})}),{intent:"success"}),t()}}),{run:u}=x.Product.Patch.usePhoto(oe,{manual:!0,onError(d,C){l({Message:"Failed Update Photo",Request:C,Error:d})},onSuccess(){m(e.jsx(A,{children:e.jsx(P,{children:"Photo Updated"})}),{intent:"success"}),t()}}),{run:j}=x.Product.Delete.usePhoto({manual:!0,onError(d,C){l({Message:"Failed Delete Photo",Request:C,Error:d})},onSuccess(){m(e.jsx(A,{children:e.jsx(P,{children:"Photo Deleted"})}),{intent:"success"}),t()}});return e.jsxs(W,{children:[e.jsx(R,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(V,{})})}),e.jsx(Y,{children:e.jsxs(Z,{children:[e.jsx(ee,{action:e.jsx(R,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(q,{})})}),children:"Image Detail"}),e.jsxs(ne,{className:a.box,children:[e.jsx(Ke,{shape:"rounded",className:a.img,Guid:r,Log:oe}),e.jsxs("div",{className:a.cap,children:[e.jsx(H,{label:"Caption",children:e.jsx(B,{value:o,onChange:(d,C)=>c(C.value)})}),e.jsx(i,{onClick:()=>p(n,o),children:"Save Caption"}),e.jsx(i,{onClick:()=>{const d=document.createElement("input");d.type="file",d.accept="image/*",d.onchange=()=>{d.files&&u(n,d.files[0])},d.click()},children:"Replace"}),e.jsx(i,{appearance:"primary",onClick:()=>j(n),children:"Delete"})]})]})]})})]})}const ie=w({f11:{flexBasis:"11%",flexGrow:0},box:{...$,justifyContent:"space-between"}}),M=new b("Admin","Product","Detail","Photo"),Fn=[Ge(70,M),h({columnId:"Caption",renderHeaderCell:()=>e.jsx(g,{children:"Caption"}),renderCell(n){return e.jsx(f,{children:n.Caption})}}),h({columnId:"Action",renderHeaderCell:()=>e.jsx(g,{className:ie().f11,children:"Action"}),renderCell(n){const{dispatch:r}=N(M),{run:s}=x.Product.Post.useMovePhoto({manual:!0,onError(t,a){r({Message:"Failed Update Order",Request:a,Error:t})},onSuccess:Q});return e.jsxs(f,{className:ie().f11,children:[e.jsx(i,{appearance:"subtle",icon:e.jsx(He,{}),onClick:()=>s(n.Id,!0)}),e.jsx(i,{appearance:"subtle",icon:e.jsx(Oe,{}),onClick:()=>s(n.Id,!1)}),e.jsx(Vn,{Photo:n,Refresh:Q})]})}})];let Q;function Un({ProdId:n}){const{data:r,run:s}=E(()=>z.Product.Get.Carousel(n,M),{onError:M.error});Q=s;const{dispatch:t,dispatchToast:a}=N(M),{run:o}=x.Product.Post.usePhoto(M,{manual:!0,onError(c,l){t({Message:"Failed Upload Photo",Request:l,Error:c})},onSuccess(){a(e.jsx(A,{children:e.jsx(P,{children:"Photo Uploaded"})}),{intent:"success"}),Q()}});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:ie().box,children:[e.jsx(be,{children:"Photos"}),e.jsx(i,{appearance:"primary",icon:e.jsx(re,{}),onClick:()=>{const c=document.createElement("input");c.type="file",c.accept="image/*",c.onchange=()=>{c.files&&o(n,c.files[0])},c.click()},children:"New Image"})]}),e.jsx(G,{Items:r||[],Columns:Fn})]})}const Hn=new b("Admin","Product","Detail","Variant","Delete");function On({VariantId:n,Refresh:r}){const{dispatch:s,dispatchToast:t}=N(Hn),{run:a}=x.Product.Delete.useVariant({manual:!0,onError(o,c){s({Message:"Failed Delete Variant",Request:c,Error:o})},onSuccess(){t(e.jsx(A,{children:e.jsx(P,{children:"Variant Deleted"})}),{intent:"success"}),r()}});return e.jsx(i,{appearance:"subtle",icon:e.jsx(J,{}),onClick:()=>a(n)})}const Mn=new b("Admin","Product","Detail","Variant","Edit","TypeDelete");function Bn({VariantId:n,Type:r,Refresh:s}){const{dispatch:t,dispatchToast:a}=N(Mn),{run:o}=x.Product.Delete.useType({manual:!0,onError(c,l){t({Message:"Failed Delete Type",Request:l,Error:c})},onSuccess(){a(e.jsx(A,{children:e.jsx(P,{children:"Type Deleted"})}),{intent:"success"}),s()}});return e.jsx(i,{appearance:"subtle",icon:e.jsx(J,{}),onClick:()=>o(n,r)})}const qn=new b("Admin","Product","Detail","Variant","Edit","Name");function Ln({Id:n,Name:r}){const[s,t]=S.useState(r),[a,{setTrue:o,setFalse:c}]=k(),{dispatch:l,dispatchToast:m}=N(qn),{run:p}=x.Product.Patch.useVariantName({manual:!0,onError(u,j){l({Message:"Failed Update Variant Name",Request:j[0],Error:u})},onSuccess(){m(e.jsx(A,{children:e.jsx(P,{children:"Variant Name Updated"})}),{intent:"success"}),c()}});return e.jsx(B,{size:"large",value:s,disabled:!a,appearance:"underline",onChange:(u,j)=>t(j.value),contentBefore:e.jsx(ve,{children:"Name"}),contentAfter:a?e.jsx(i,{appearance:"subtle",icon:e.jsx(K,{}),onClick:()=>p(n,s)}):e.jsx(i,{appearance:"subtle",icon:e.jsx(V,{}),onClick:o})})}const zn=w({body:{...O,rowGap:T.spacingVerticalM}}),_n=new b("Admin","Product","Detail","Variant","Edit","Type");function Ve({VariantId:n,Type:r,Refresh:s,New:t}){const a=zn(),[o,{toggle:c}]=k(),[l,m]=S.useState(r||""),{dispatch:p,dispatchToast:u}=N(_n),j={manual:!0,onError(v,y){p({Message:`Failed ${t?"Create":"Update"} Type ${l}`,Request:y,Error:v})},onSuccess(v){u(e.jsxs(A,{children:[e.jsxs(P,{children:["Type ",t?"Created":"Updated"]}),e.jsxs(Me,{children:[v," ",l]})]}),{intent:"success"}),s(),m(""),c()}},{run:d}=x.Product.Post.useType(j),{run:C}=x.Product.Patch.useType(j);return e.jsxs(Ie,{withArrow:!0,open:o,onOpenChange:c,children:[e.jsx(ke,{disableButtonEnhancement:!0,children:t?e.jsx(i,{icon:e.jsx(re,{}),appearance:"primary",children:"New Type"}):e.jsx(i,{appearance:"subtle",icon:e.jsx(V,{})})}),e.jsxs($e,{className:a.body,children:[e.jsx(H,{label:"Type Name",children:e.jsx(B,{value:l,onChange:(v,y)=>m(y.value)})}),e.jsx(i,{onClick:()=>t?d(n,l):C(n,r,l),children:"Submit"})]})]})}const de=w({body:{...O,rowGap:T.spacingVerticalM},twelve:{flexBasis:"12%",flexGrow:0}}),Xn=[h({columnId:"Name",renderHeaderCell:()=>e.jsx(g,{children:"Name"}),renderCell(n){return e.jsx(f,{children:n.Name})}}),h({columnId:"Action",renderHeaderCell:()=>e.jsx(g,{className:de().twelve,children:"Action"}),renderCell(n){return e.jsxs(f,{className:de().twelve,children:[e.jsx(Ve,{VariantId:n.VariantId,Type:n.Name,Refresh:n.Refresh}),e.jsx(Bn,{VariantId:n.VariantId,Type:n.Name,Refresh:n.Refresh})]})}})];function Qn({Variant:n,Refresh:r}){return e.jsxs(W,{children:[e.jsx(R,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(V,{})})}),e.jsx(Y,{children:e.jsxs(Z,{children:[e.jsx(ee,{action:e.jsx(R,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(q,{})})}),children:"Variant Detail"}),e.jsxs(ne,{className:de().body,children:[e.jsx(Ln,{Id:n.Id,Name:n.Name}),e.jsx(G,{Items:n.Types.map((s,t)=>({Id:t,Name:s,VariantId:n.Id,Refresh:r})),Columns:Xn})]}),e.jsx(Be,{children:e.jsx(Ve,{VariantId:n.Id,Refresh:r,New:!0})})]})})]})}const Kn=w({body:{...O,rowGap:T.spacingVerticalM}}),Jn=new b("Admin","Product","Detail","Variant","New");function Wn({ProdId:n,Refresh:r}){const s=Kn(),[t,{toggle:a}]=k(),[o,c]=S.useState(""),{dispatch:l,dispatchToast:m}=N(Jn),{run:p}=x.Product.Post.useVariant({manual:!0,onError(u,j){l({Message:"Failed Create Variant",Request:j,Error:u})},onSuccess(){m(e.jsx(A,{children:e.jsx(P,{children:"Variant Created"})}),{intent:"success"}),r(),c(""),a()}});return e.jsxs(Ie,{withArrow:!0,open:t,onOpenChange:a,children:[e.jsx(ke,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"primary",icon:e.jsx(re,{}),children:"New Variant"})}),e.jsxs($e,{className:s.body,children:[e.jsx(H,{required:!0,label:"Variant Name",children:e.jsx(B,{value:o,onChange:(u,j)=>c(j.value)})}),e.jsx(i,{onClick:()=>p(n,o),children:"Add"})]})]})}const U=w({body:{...$,justifyContent:"space-between"},four:{flexBasis:"4%",flexGrow:0},seven:{flexBasis:"7%",flexGrow:0},twelve:{flexBasis:"12%",flexGrow:0}}),Se=new b("Admin","Product","Detail","Variant"),Yn=[h({columnId:"Id",renderHeaderCell:()=>e.jsx(g,{className:U().four,children:"Id"}),renderCell(n){return e.jsx(f,{className:U().four,children:n.Id})}}),h({columnId:"Name",renderHeaderCell:()=>e.jsx(g,{className:U().twelve,children:"Name"}),renderCell(n){return e.jsx(f,{className:U().twelve,children:n.Name})}}),h({columnId:"Type",renderHeaderCell:()=>e.jsx(g,{children:"Type"}),renderCell(n){return e.jsx(f,{children:n.Types.reduce((r,s)=>`${r} ${s} ;`,"")})}}),h({columnId:"Action",renderHeaderCell:()=>e.jsx(g,{className:U().seven,children:"Action"}),renderCell(n){return e.jsxs(f,{className:U().seven,children:[e.jsx(Qn,{Variant:n,Refresh:ue}),e.jsx(On,{VariantId:n.Id,Refresh:ue})]})}})];let ue;function Zn({ProdId:n}){const r=U(),{data:s,run:t}=E(()=>x.Product.Get.Variants(n,Se),{onError:Se.error});return ue=t,e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:r.body,children:[e.jsx(be,{children:"Variant"}),e.jsx(Wn,{ProdId:n,Refresh:t})]}),e.jsx(G,{Items:s||[],Columns:Yn})]})}const er=w({body:{...O,rowGap:T.spacingVerticalXL,paddingBottom:T.spacingVerticalXXXL}});function nr({ProdId:n}){const r=er(),[s,{toggle:t,setTrue:a}]=k(),{Nav:o,Paths:c}=L();return S.useEffect(()=>{parseInt(c.at(1))===n&&a()},[c]),e.jsxs(e.Fragment,{children:[e.jsx(i,{appearance:"subtle",icon:e.jsx(Ee,{}),onClick:()=>{o("Admin",n),a()}}),e.jsxs(he,{open:s,onOpenChange:t,position:"end",size:"large",modalType:"alert",children:[e.jsx(je,{children:e.jsx(pe,{action:e.jsx(i,{appearance:"subtle",icon:e.jsx(q,{}),onClick:()=>{o("Admin"),t()}}),children:"Product Detail"})}),e.jsxs(Ce,{className:r.body,children:[e.jsx(Gn,{ProdId:n}),e.jsx(gn,{ProdId:n}),e.jsx(Un,{ProdId:n}),e.jsx(Zn,{ProdId:n}),e.jsx(En,{ProdId:n}),e.jsx($n,{ProdId:n}),e.jsx(vn,{ProdId:n})]})]})]})}const De=w({two:{flexBasis:"2.5%",flexGrow:0},twoc:{flexBasis:"2.5%",flexGrow:0,justifyContent:"center"}}),me=new b("Admin","Product"),rr=[Ge(50,me),h({columnId:"Product",renderHeaderCell:()=>e.jsx(g,{children:"Product"}),renderCell(n){return e.jsx(f,{children:e.jsx(ye,{children:n.Name})})}}),h({columnId:"Category",renderHeaderCell:()=>e.jsx(g,{children:"Category"}),renderCell(n){return e.jsx(f,{children:e.jsx(ye,{children:n.Category})})}}),h({columnId:"Variant",renderHeaderCell:()=>e.jsx(g,{children:"Variant"}),renderCell(n){return e.jsx(f,{children:n.Variant})}}),h({columnId:"Combo",renderHeaderCell:()=>e.jsx(g,{children:"Combo"}),renderCell(n){return e.jsx(f,{children:n.Combo})}}),h({columnId:"Stock",renderHeaderCell:()=>e.jsx(g,{children:"Stock"}),renderCell(n){return e.jsx(f,{children:n.Stock})}}),h({columnId:"Action",renderHeaderCell:()=>e.jsx(g,{className:De().two,children:"Detail"}),renderCell(n){return e.jsx(f,{className:De().twoc,children:e.jsx(nr,{ProdId:n.Id})})}})];function sr(){const{data:n}=E(()=>x.Product.Get.List(me),{onError:me.error});return e.jsx(G,{Items:n||[],Columns:rr})}function tr({Items:n,Columns:r,NoHeader:s}){return e.jsxs(qe,{items:n,columns:r,getRowId:t=>t.Id,children:[!s&&e.jsx(Le,{children:e.jsx(Ae,{children:({renderHeaderCell:t})=>e.jsx(g,{children:t()})})}),e.jsx(ze,{children:({item:t,rowId:a})=>e.jsx(Ae,{children:({renderCell:o})=>e.jsx(f,{children:o(t)})},a)})]})}const ar=new b("Admin","User","Delete");function cr({UserId:n,Refresh:r}){const{dispatch:s,dispatchToast:t}=N(ar),{run:a}=x.User.Delete.useUser({manual:!0,onError(o,c){s({Message:"Failed Delete User",Request:c,Error:o})},onSuccess(){t(e.jsx(A,{children:e.jsx(P,{children:"User Deleted"})}),{intent:"success"}),r()}});return e.jsx(i,{appearance:"subtle",icon:e.jsx(J,{}),onClick:()=>a(n)})}const or=new b("Admin","User","Grant");function lr({UserId:n,Admin:r,Refresh:s}){const{dispatch:t,dispatchToast:a}=N(or),{run:o}=x.User.Post.useAdmin({manual:!0,onError(l,m){t({Message:"Failed Grant Admin",Request:m,Error:l})},onSuccess(){a(e.jsx(A,{children:e.jsx(P,{children:"Admin Granted"})}),{intent:"success"}),s()}}),{run:c}=x.User.Delete.useAdmin({manual:!0,onError(l,m){t({Message:"Failed Revoke Admin",Request:m,Error:l})},onSuccess(){a(e.jsx(A,{children:e.jsx(P,{children:"Admin Revoked"})}),{intent:"success"}),s()}});return e.jsx(_e,{checked:r,onChange:(l,m)=>{m.checked?o(n):c(n)}})}const ir=new b("Admin","User"),dr=[h({columnId:"Id",renderHeaderCell:()=>"Id",renderCell(n){return n.Id}}),h({columnId:"Name",renderHeaderCell:()=>"Real Name",renderCell(n){return n.Name}}),h({columnId:"Email",renderHeaderCell:()=>"E-Mail",renderCell(n){return n.EMail}}),h({columnId:"Admin",renderHeaderCell:()=>"Admin",renderCell(n){return e.jsx(lr,{UserId:n.Id,Admin:n.Admin,Refresh:xe})}}),h({columnId:"Delete",renderHeaderCell:()=>"Delete",renderCell(n){return e.jsx(cr,{UserId:n.Id,Refresh:xe})}})];let xe;function ur(){const{data:n,run:r}=E(()=>x.User.Get.List(),{onError:ir.error});return xe=r,e.jsx(tr,{Items:n||[],Columns:dr})}const mr=new b("Admin");function fr(){const{Paths:n,Nav:r}=L(),s=n.at(1),t=S.useMemo(()=>{switch(s){case"Order":return e.jsx(pn,{});case"User":return e.jsx(ur,{});default:return e.jsx(sr,{})}},[s]),{data:a,loading:o}=z.User.Get.useMe(mr);return o?e.jsx(Xe,{size:"huge",label:"Authenticating..."}):a?.Admin?t:r("/")}export{fr as default};
