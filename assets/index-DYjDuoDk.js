import{m as E,a9 as m,v as T,j as e,L as M,ae as ue,t as D,aa as j,ab as p,r as A,p as G,T as g,b as f,aH as me,aI as z,B as i,aJ as he,aK as F,af as Y,D as J,o as V,g as K,h as Z,i as ee,aj as Q,k as ne,Q as se,aE as xe,an as je,ao as pe,ar as Ce,ag as Ae,ah as De,ai as Ee,ak as Se,I as W,R as Ie,F as ge,N as Ve,aL as ke,aM as Ue,c as He,n as Fe,aN as Me,E as Be,a5 as ve,a3 as Le,a4 as Oe,a6 as qe,a7 as ze,ac as fe,aO as _e,au as Xe}from"./vendor-lfEbh0Xp.js";import{L as x,A as d,e as k,F as $,f as y,H as B,a as L,c as re,C as Qe,G as We,M as Te}from"./index-Cm0DkfbN.js";import{H as Ye,O as Je}from"./Columns-De0vjwiy.js";import{L as Ke}from"./Lazy-Dda5yWRN.js";const q=E({two:{flexBasis:"2.5%",flexGrow:0},twoc:{flexBasis:"2.5%",flexGrow:0,justifyContent:"center"},ten:{flexBasis:"10%",flexGrow:0},page:{...$,alignItems:"center",justifyContent:"flex-end",paddingTop:D.spacingVerticalXL,columnGap:D.spacingHorizontalM},spin:{width:"4rem"}}),_=new x("Admin","Order"),Ze=[...Ye(_).slice(0,-1),m({columnId:"User",renderHeaderCell:()=>e.jsx(j,{className:q().ten,children:"User"}),renderCell(n){return e.jsx(p,{className:q().ten,children:n.User})}}),m({columnId:"Action",renderHeaderCell:()=>e.jsx(j,{className:q().two,children:"Action"}),renderCell(n){return e.jsx(p,{className:q().twoc,children:e.jsx(Je,{OrderId:n.Id,ParentLog:_,Admin:!0})})}})];function en(){const n=q(),{data:r}=T(()=>d.Order.Get.Count(),{onError:_.error}),s=Math.ceil((r||1)/30),{data:t,run:a}=T(o=>d.Order.Get.List(o,_),{defaultParams:[1],debounceWait:300,onError:_.error});return e.jsxs(e.Fragment,{children:[e.jsx(k,{Items:t,Columns:Ze}),e.jsxs("div",{className:n.page,children:[e.jsxs(M,{children:["Total ",r," Records"]}),e.jsx(ue,{min:1,max:s,defaultValue:1,className:n.spin,onChange:(o,c)=>{const l=parseInt(c.value||c.displayValue);!isNaN(l)&&l&&l<=s&&a(l)}}),e.jsx(M,{children:"/"}),e.jsx(M,{children:s})]})]})}const nn=E({body:{...$,alignItems:"center"},input:{flexGrow:1}}),te=new x("Admin","Product","Detail","Category");function sn({ProdId:n}){const[r,s]=A.useState(""),[t,{setTrue:a,setFalse:o}]=G();T(()=>d.Product.Get.Category(n),{onSuccess(P){P&&s(P)},onError:te.error});const{dispatch:c,dispatchToast:l}=y(te),{run:u}=d.Product.Patch.useCategory({manual:!0,onError(P,v){c({Message:"Failed Update Category",Request:v,Error:P})},onSuccess(){l(e.jsx(g,{children:e.jsx(f,{children:"Category Updated"})}),{intent:"success"}),o()}}),{run:b}=d.Product.Delete.useCategory({manual:!0,onError(P,v){c({Message:"Failed Detach Category",Request:v,Error:P})},onSuccess(){l(e.jsx(g,{children:e.jsx(f,{children:"Category Detached"})}),{intent:"success"}),o()}}),{data:h}=T(()=>B.Gallery.Get.Categories(),{onSuccess(P){S(P)},onError:te.error}),[C,S]=A.useState(h),[N,w]=A.useState(""),I=nn();return e.jsxs("div",{className:I.body,children:[e.jsx(M,{size:"large",disabled:!t,children:"Category"}),e.jsxs(me,{className:I.input,size:"large",disabled:!t,freeform:!0,placeholder:r||"Pending",appearance:"underline",onChange:P=>{const v=P.target.value.trim(),R=h?.filter(Re=>Re.toLowerCase().indexOf(v.toLowerCase())===0);S(R),v&&R&&R.length<1?w(v):w("")},onOptionSelect:(P,v)=>{const R=v.optionText;s(R),R&&h?.includes(R)?w(""):w(R)},children:[N&&e.jsxs(z,{text:N,children:['Create New "',N,'"']},N),C?.map(P=>e.jsx(z,{children:P},P)),C?.length===h?.length?e.jsx(z,{text:"",children:"Pending"},""):null]}),t?e.jsx(i,{appearance:"subtle",icon:e.jsx(he,{}),onClick:()=>{r?u(n,r):b(n)}}):e.jsx(i,{appearance:"subtle",icon:e.jsx(F,{}),onClick:a})]})}const rn=new x("Admin","Product","Detail","Combo","Delete");function tn({ComboId:n,Refresh:r}){const{dispatch:s,dispatchToast:t}=y(rn),{run:a}=d.Product.Delete.useCombo({manual:!0,onError(o,c){s({Message:"Failed Delete Combo",Request:c,Error:o})},onSuccess(){t(e.jsx(g,{children:e.jsx(f,{children:"Combo Deleted"})}),{intent:"success"}),r()}});return e.jsx(i,{appearance:"subtle",icon:e.jsx(Y,{}),onClick:()=>a(n)})}const an=[m({columnId:"Variant",renderHeaderCell:()=>e.jsx(j,{children:"Variant"}),renderCell(n){return e.jsx(p,{children:n.Name})}}),m({columnId:"Type",renderHeaderCell:()=>e.jsx(j,{children:"Type"}),renderCell(n){return e.jsx(p,{children:e.jsx(me,{defaultValue:n.Current,defaultSelectedOptions:[n.Current],onOptionSelect:(r,s)=>n.Update(s.optionValue),children:n.Types.map((r,s)=>e.jsx(z,{children:r},s))})})}})],on=E({body:{...$,justifyContent:"flex-end",alignItems:"center",columnGap:D.spacingVerticalM,marginTop:D.spacingHorizontalM}}),ae=new x("Admin","Product","Detail","Combo","Detail");function cn({Id:n,ProdId:r,Combo:s,Stock:t,Refresh:a}){const[o,{toggle:c}]=G(),[l,u]=A.useState(s),[b,h]=A.useState(t),{data:C}=T(()=>d.Product.Get.Variants(r,ae),{onError:ae.error}),{dispatch:S,dispatchToast:N}=y(ae),{run:w}=d.Product.Patch.useCombo({manual:!0,onError(I,P){S({Message:"Failed Update Combo",Request:P,Error:I})},onSuccess(){N(e.jsx(g,{children:e.jsx(f,{children:"Combo Updated"})}),{intent:"success"}),a(),c()}});return e.jsxs(J,{open:o,onOpenChange:c,children:[e.jsx(V,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(F,{})})}),e.jsx(K,{children:e.jsxs(Z,{children:[e.jsx(ee,{action:e.jsx(V,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(Q,{})})}),children:"Combo Detail"}),e.jsxs(ne,{children:[e.jsx(k,{Items:C?.map(I=>({Current:l[I.Name],Update(P){l[I.Name]=P,u({...l})},...I})),Columns:an}),e.jsxs("div",{className:on().body,children:[e.jsx(M,{children:"Stock"}),e.jsx(ue,{value:b,min:0,onChange:(I,P)=>{const v=parseInt(P.value||P.displayValue);isNaN(v)||v<0||h(v)}}),e.jsx(i,{appearance:"primary",onClick:()=>w(n,l,b),children:"Submit"})]})]})]})})]})}const ln=[m({columnId:"Variant",renderHeaderCell:()=>e.jsx(j,{children:"Variant"}),renderCell(n){return e.jsx(p,{children:n.Name})}}),m({columnId:"Type",renderHeaderCell:()=>e.jsx(j,{children:"Type"}),renderCell(n){return e.jsx(p,{children:e.jsx(me,{onOptionSelect:(r,s)=>n.Update(s.optionValue),children:n.Types.map((r,s)=>e.jsx(z,{children:r},s))})})}})],dn=E({body:{...$,justifyContent:"flex-end",alignItems:"center",columnGap:D.spacingVerticalM,marginTop:D.spacingHorizontalM}}),oe=new x("Admin","Product","Detail","Combo","NewCombo");function un({ProdId:n,Refresh:r}){const[s,{toggle:t}]=G(),[a,o]=A.useState({}),[c,l]=A.useState(1),{data:u}=T(()=>d.Product.Get.Variants(n,oe),{onSuccess(S){for(const N of S)a[N.Name]="";o({...a})},onError:oe.error}),{dispatch:b,dispatchToast:h}=y(oe),{run:C}=d.Product.Post.useCombo({manual:!0,onError(S,N){b({Message:"Failed Create Combo",Request:N,Error:S})},onSuccess(){h(e.jsx(g,{children:e.jsx(f,{children:"Combo Created"})}),{intent:"success"}),r(),t()}});return e.jsxs(J,{open:s,onOpenChange:t,children:[e.jsx(V,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"primary",icon:e.jsx(se,{}),children:"New Combo"})}),e.jsx(K,{children:e.jsxs(Z,{children:[e.jsx(ee,{action:e.jsx(V,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(Q,{})})}),children:"New Combo"}),e.jsxs(ne,{children:[e.jsx(k,{Items:u?.map(S=>({Update(N){a[S.Name]=N,o({...a})},...S})),Columns:ln}),e.jsxs("div",{className:dn().body,children:[e.jsx(M,{children:"Stock"}),e.jsx(ue,{value:c,min:0,onChange:(S,N)=>{const w=parseInt(N.value||N.displayValue);isNaN(w)||w<0||l(w)}}),e.jsx(i,{appearance:"primary",onClick:()=>C(n,a,c),children:"Create"})]})]})]})})]})}const U=E({body:{...$,justifyContent:"space-between"},four:{flexBasis:"4%",flexGrow:0},seven:{flexBasis:"7%",flexGrow:0},five:{flexBasis:"5%",flexGrow:0}}),Pe=new x("Admin","Product","Detail","Combo"),mn=[m({columnId:"Id",renderHeaderCell:()=>e.jsx(j,{className:U().four,children:"Id"}),renderCell(n){return e.jsx(p,{className:U().four,children:n.Id})}}),m({columnId:"Combo",renderHeaderCell:()=>e.jsx(j,{children:"Combo"}),renderCell(n){return e.jsx(p,{children:Object.entries(n.Combo).reduce((r,s)=>`${r} ${s[0]} : ${s[1]} ;`,"")})}}),m({columnId:"Stock",renderHeaderCell:()=>e.jsx(j,{className:U().five,children:"Stock"}),renderCell(n){return e.jsx(p,{className:U().five,children:n.Stock})}}),m({columnId:"Action",renderHeaderCell:()=>e.jsx(j,{className:U().seven,children:"Action"}),renderCell(n){return e.jsxs(p,{className:U().seven,children:[e.jsx(cn,{...n}),e.jsx(tn,{ComboId:n.Id,Refresh:n.Refresh})]})}})];function hn({ProdId:n}){const{data:r,run:s}=T(()=>B.Product.Get.ComboItem(n,Pe),{onError:Pe.error});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:U().body,children:[e.jsx(xe,{children:"Combo"}),e.jsx(un,{ProdId:n,Refresh:s})]}),e.jsx(k,{Items:r?.map(t=>({ProdId:n,Refresh:s,...t})),Columns:mn})]})}const xn=new x("Admin","Product","Detail","Delete"),jn=E({root:{...L,rowGap:D.spacingHorizontalS}});function pn({ProdId:n}){const{Nav:r}=re(),{dispatch:s,dispatchToast:t}=y(xn),{run:a,loading:o}=d.Product.Delete.useProduct({manual:!0,onError(l,u){s({Message:"Failed Delete Product",Request:u,Error:l})},onSuccess(){t(e.jsx(g,{children:e.jsx(f,{children:"Product Deleted"})}),{intent:"success"}),r("/Admin")}}),c=jn();return e.jsx("div",{children:e.jsxs(je,{withArrow:!0,children:[e.jsx(pe,{disableButtonEnhancement:!0,children:e.jsx(i,{children:"Delete Product"})}),e.jsxs(Ce,{className:c.root,children:["Are You Sure?",e.jsx(i,{disabled:o,appearance:"primary",onClick:()=>a(n),children:"Yes"})]})]})})}const Cn=E({btn:{...$,columnGap:D.spacingVerticalS},drawer:{width:"1100px"}}),gn=new x("Admin","Product","Lexical");function fn({ProdId:n}){const r=Cn(),[s,{toggle:t,setTrue:a}]=G(),{data:o,run:c}=T(()=>B.Product.Get.Lexical(n)),{dispatch:l,dispatchToast:u}=y(gn),{run:b}=d.Product.Post.useLexical({manual:!0,onError(h,C){l({Message:"Failed Update Description",Request:C,Error:h})},onSuccess(){u(e.jsx(g,{children:e.jsx(f,{children:"Description Updated"})}),{intent:"success"}),c(),t()}});return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx(i,{onClick:()=>a(),children:"Open Description Editor"})}),e.jsxs(Ae,{open:s,onOpenChange:t,position:"start",size:"large",modalType:"alert",className:r.drawer,children:[e.jsx(De,{children:e.jsx(Ee,{action:e.jsxs("div",{className:r.btn,children:[e.jsx(i,{appearance:"primary",onClick:()=>b(n),children:"Save"}),e.jsx(i,{onClick:()=>t(),children:"Cancel"})]}),children:"Edit Product Description"})}),e.jsx(Se,{children:e.jsx(Ke,{State:o?.Description})})]})]})}const be=new x("Admin","Product","Detail","Name");function Pn({ProdId:n}){const[r,s]=A.useState(""),[t,{setTrue:a,setFalse:o}]=G(),{Nav:c}=re();T(()=>d.Product.Get.Name(n),{onSuccess(h){s(h)},onError(h){c("Admin"),be.error(h)}});const{dispatch:l,dispatchToast:u}=y(be),{run:b}=d.Product.Patch.useName({manual:!0,onError(h,C){l({Message:"Failed Update Name",Request:C,Error:h})},onSuccess(){u(e.jsx(g,{children:e.jsx(f,{children:"Name Updated"})}),{intent:"success"}),o()}});return e.jsx(W,{size:"large",value:r,disabled:!t,appearance:"underline",onChange:(h,C)=>s(C.value),contentBefore:e.jsx(Ie,{children:"Name"}),contentAfter:t?e.jsx(i,{appearance:"subtle",icon:e.jsx(he,{}),onClick:()=>b(n,r)}):e.jsx(i,{appearance:"subtle",icon:e.jsx(F,{}),onClick:a})})}const bn=new x("Admin","Product","Detail","Photo","Edit","Caption");function yn({Id:n,Caption:r}){const[s,t]=A.useState(r||""),{dispatch:a,dispatchToast:o}=y(bn),{run:c}=d.Product.Patch.useCaption({manual:!0,onError(l,u){a({Message:"Failed Update Caption",Request:u,Error:l})},onSuccess(){o(e.jsx(g,{children:e.jsx(f,{children:"Caption Updated"})}),{intent:"success"})}});return e.jsxs(e.Fragment,{children:[e.jsx(ge,{label:"Caption",children:e.jsx(W,{value:s,placeholder:"Write some infomation here?",onChange:(l,u)=>t(u.value)})}),e.jsx(i,{onClick:()=>c(n,s),children:"Save Caption"})]})}const Nn=new x("Admin","Product","Detail","Photo","Edit","Delete");function wn({Id:n,ProductId:r}){const{dispatch:s,dispatchToast:t}=y(Nn),{run:a}=d.Product.Delete.usePhoto({manual:!0,onError(o,c){s({Message:"Failed Delete Photo",Request:c,Error:o})},onSuccess(){t(e.jsx(g,{children:e.jsx(f,{children:"Photo Deleted"})}),{intent:"success"})}});return e.jsx(i,{appearance:"primary",onClick:()=>a(r,n),children:"Delete"})}const ye=new x("Admin","Product","Detail","Photo","Edit","Replace");function An({Id:n}){const{dispatch:r,dispatchToast:s}=y(ye),{run:t}=d.Product.Patch.usePhoto(ye,{manual:!0,onBefore([a,o]){s(e.jsx(g,{children:e.jsxs(f,{children:["Uploading Photo ",o.name," for Product ",a," to replace ",n]})}),{intent:"info"})},onError(a,o){r({Message:"Failed Update Photo",Request:o,Error:a})},onSuccess(){s(e.jsx(g,{children:e.jsx(f,{children:"Photo Updated"})}),{intent:"success"})}});return e.jsx(i,{onClick:()=>{const a=document.createElement("input");a.type="file",a.accept="image/*",a.onchange=()=>{a.files&&t(n,a.files[0])},a.click()},children:"Replace"})}const Dn=E({box:{...$,columnGap:D.spacingHorizontalL},img:{...Qe,aspectRatio:"1",width:"50%"},cap:{...L,flexGrow:1,rowGap:D.spacingVerticalL}}),En=new x("Admin","Product","Detail","Photo","Edit");function Sn(n){const{Id:r,Cover:s}=n,t=Dn();return e.jsxs(J,{children:[e.jsx(V,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(F,{})})}),e.jsx(K,{children:e.jsxs(Z,{children:[e.jsx(ee,{action:e.jsx(V,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(Q,{})})}),children:"Image Detail"}),e.jsxs(ne,{className:t.box,children:[e.jsx(We,{shape:"rounded",className:t.img,Guid:s,Log:En}),e.jsxs("div",{className:t.cap,children:[e.jsx(yn,{...n}),e.jsx(An,{Id:r}),e.jsx(wn,{...n})]})]})]})})]})}const ce=E({f11:{flexBasis:"11%",flexGrow:0},box:{...$,justifyContent:"space-between"}}),X=new x("Admin","Product","Detail","Photo"),In=[Te(70,X),m({columnId:"Caption",renderHeaderCell:()=>e.jsx(j,{children:"Caption"}),renderCell(n){return e.jsx(p,{children:n.Caption||"No Caption"})}}),m({columnId:"Action",renderHeaderCell:()=>e.jsx(j,{className:ce().f11,children:"Action"}),renderCell(n){const{dispatch:r}=y(X),{run:s}=d.Product.Post.useMovePhoto({manual:!0,onError(t,a){r({Message:"Failed Update Order",Request:a,Error:t})},onSuccess:vn});return e.jsxs(p,{className:ce().f11,children:[e.jsx(i,{appearance:"subtle",icon:e.jsx(ke,{}),onClick:()=>s(n.Id,!0)}),e.jsx(i,{appearance:"subtle",icon:e.jsx(Ue,{}),onClick:()=>s(n.Id,!1)}),e.jsx(Sn,{...n})]})}})];let vn=()=>{};function Tn({ProdId:n}){const r=Ve(async()=>{const[o]=await B.Product.Get.PhotoList(n,X);return o.map(l=>({Id:l.PhotoId,Cover:l.ObjectId,Caption:l.Caption,ProductId:l.ProductId}))}),{dispatch:s,dispatchToast:t}=y(X),{run:a}=d.Product.Post.usePhoto(X,{manual:!0,onBefore([o,c]){t(e.jsx(g,{children:e.jsxs(f,{children:["Uploading Photo ",c.name," for Product ",o]})}),{intent:"info"})},onError(o,c){s({Message:"Failed Upload Photo",Request:c,Error:o})},onSuccess(){t(e.jsx(g,{children:e.jsx(f,{children:"Photo Uploaded"})}),{intent:"success"})}});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:ce().box,children:[e.jsx(xe,{children:"Photos"}),e.jsx(i,{appearance:"primary",icon:e.jsx(se,{}),onClick:()=>{const o=document.createElement("input");o.type="file",o.accept="image/*",o.onchange=()=>{o.files&&a(n,o.files[0])},o.click()},children:"New Image"})]}),e.jsx(k,{Items:r,Columns:In})]})}const Gn=new x("Admin","Product","Detail","Variant","Delete");function $n({VariantId:n,Refresh:r}){const{dispatch:s,dispatchToast:t}=y(Gn),{run:a}=d.Product.Delete.useVariant({manual:!0,onError(o,c){s({Message:"Failed Delete Variant",Request:c,Error:o})},onSuccess(){t(e.jsx(g,{children:e.jsx(f,{children:"Variant Deleted"})}),{intent:"success"}),r()}});return e.jsx(i,{appearance:"subtle",icon:e.jsx(Y,{}),onClick:()=>a(n)})}const Rn=new x("Admin","Product","Detail","Variant","Edit","TypeDelete");function Vn({VariantId:n,Type:r,Refresh:s}){const{dispatch:t,dispatchToast:a}=y(Rn),{run:o}=d.Product.Delete.useType({manual:!0,onError(c,l){t({Message:"Failed Delete Type",Request:l,Error:c})},onSuccess(){a(e.jsx(g,{children:e.jsx(f,{children:"Type Deleted"})}),{intent:"success"}),s()}});return e.jsx(i,{appearance:"subtle",icon:e.jsx(Y,{}),onClick:()=>o(n,r)})}const kn=new x("Admin","Product","Detail","Variant","Edit","Name");function Un({Id:n,Name:r}){const[s,t]=A.useState(r),[a,{setTrue:o,setFalse:c}]=G(),{dispatch:l,dispatchToast:u}=y(kn),{run:b}=d.Product.Patch.useVariantName({manual:!0,onError(h,C){l({Message:"Failed Update Variant Name",Request:C[0],Error:h})},onSuccess(){u(e.jsx(g,{children:e.jsx(f,{children:"Variant Name Updated"})}),{intent:"success"}),c()}});return e.jsx(W,{size:"large",value:s,disabled:!a,appearance:"underline",onChange:(h,C)=>t(C.value),contentBefore:e.jsx(Ie,{children:"Name"}),contentAfter:a?e.jsx(i,{appearance:"subtle",icon:e.jsx(he,{}),onClick:()=>b(n,s)}):e.jsx(i,{appearance:"subtle",icon:e.jsx(F,{}),onClick:o})})}const Hn=E({body:{...L,rowGap:D.spacingVerticalM}}),Fn=new x("Admin","Product","Detail","Variant","Edit","Type");function Ge({VariantId:n,Type:r,Refresh:s,New:t}){const a=Hn(),[o,{toggle:c}]=G(),[l,u]=A.useState(r||""),{dispatch:b,dispatchToast:h}=y(Fn),C={manual:!0,onError(w,I){b({Message:`Failed ${t?"Create":"Update"} Type ${l}`,Request:I,Error:w})},onSuccess(w){h(e.jsxs(g,{children:[e.jsxs(f,{children:["Type ",t?"Created":"Updated"]}),e.jsxs(He,{children:[w," ",l]})]}),{intent:"success"}),s(),u(""),c()}},{run:S}=d.Product.Post.useType(C),{run:N}=d.Product.Patch.useType(C);return e.jsxs(je,{withArrow:!0,open:o,onOpenChange:c,children:[e.jsx(pe,{disableButtonEnhancement:!0,children:t?e.jsx(i,{icon:e.jsx(se,{}),appearance:"primary",children:"New Type"}):e.jsx(i,{appearance:"subtle",icon:e.jsx(F,{})})}),e.jsxs(Ce,{className:a.body,children:[e.jsx(ge,{label:"Type Name",children:e.jsx(W,{value:l,onChange:(w,I)=>u(I.value)})}),e.jsx(i,{onClick:()=>t?S(n,l):N(n,r,l),children:"Submit"})]})]})}const le=E({body:{...L,rowGap:D.spacingVerticalM},twelve:{flexBasis:"12%",flexGrow:0}}),Mn=[m({columnId:"Name",renderHeaderCell:()=>e.jsx(j,{children:"Name"}),renderCell(n){return e.jsx(p,{children:n.Name})}}),m({columnId:"Action",renderHeaderCell:()=>e.jsx(j,{className:le().twelve,children:"Action"}),renderCell(n){return e.jsxs(p,{className:le().twelve,children:[e.jsx(Ge,{VariantId:n.VariantId,Type:n.Name,Refresh:n.Refresh}),e.jsx(Vn,{VariantId:n.VariantId,Type:n.Name,Refresh:n.Refresh})]})}})];function Bn({Variant:n,Refresh:r}){return e.jsxs(J,{children:[e.jsx(V,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(F,{})})}),e.jsx(K,{children:e.jsxs(Z,{children:[e.jsx(ee,{action:e.jsx(V,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(Q,{})})}),children:"Variant Detail"}),e.jsxs(ne,{className:le().body,children:[e.jsx(Un,{Id:n.Id,Name:n.Name}),e.jsx(k,{Items:n.Types.map((s,t)=>({Id:t,Name:s,VariantId:n.Id,Refresh:r})),Columns:Mn})]}),e.jsx(Fe,{children:e.jsx(Ge,{VariantId:n.Id,Refresh:r,New:!0})})]})})]})}const Ln=E({body:{...L,rowGap:D.spacingVerticalM}}),On=new x("Admin","Product","Detail","Variant","New");function qn({ProdId:n,Refresh:r}){const s=Ln(),[t,{toggle:a}]=G(),[o,c]=A.useState(""),{dispatch:l,dispatchToast:u}=y(On),{run:b}=d.Product.Post.useVariant({manual:!0,onError(h,C){l({Message:"Failed Create Variant",Request:C,Error:h})},onSuccess(){u(e.jsx(g,{children:e.jsx(f,{children:"Variant Created"})}),{intent:"success"}),r(),c(""),a()}});return e.jsxs(je,{withArrow:!0,open:t,onOpenChange:a,children:[e.jsx(pe,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"primary",icon:e.jsx(se,{}),children:"New Variant"})}),e.jsxs(Ce,{className:s.body,children:[e.jsx(ge,{required:!0,label:"Variant Name",children:e.jsx(W,{value:o,onChange:(h,C)=>c(C.value)})}),e.jsx(i,{onClick:()=>b(n,o),children:"Add"})]})]})}const H=E({body:{...$,justifyContent:"space-between"},four:{flexBasis:"4%",flexGrow:0},seven:{flexBasis:"7%",flexGrow:0},twelve:{flexBasis:"12%",flexGrow:0}}),Ne=new x("Admin","Product","Detail","Variant"),zn=[m({columnId:"Id",renderHeaderCell:()=>e.jsx(j,{className:H().four,children:"Id"}),renderCell(n){return e.jsx(p,{className:H().four,children:n.Id})}}),m({columnId:"Name",renderHeaderCell:()=>e.jsx(j,{className:H().twelve,children:"Name"}),renderCell(n){return e.jsx(p,{className:H().twelve,children:n.Name})}}),m({columnId:"Type",renderHeaderCell:()=>e.jsx(j,{children:"Type"}),renderCell(n){return e.jsx(p,{children:n.Types.reduce((r,s)=>`${r} ${s} ;`,"")})}}),m({columnId:"Action",renderHeaderCell:()=>e.jsx(j,{className:H().seven,children:"Action"}),renderCell(n){return e.jsxs(p,{className:H().seven,children:[e.jsx(Bn,{Variant:n,Refresh:ie}),e.jsx($n,{VariantId:n.Id,Refresh:ie})]})}})];let ie;function _n({ProdId:n}){const r=H(),{data:s,run:t}=T(()=>d.Product.Get.Variants(n,Ne),{onError:Ne.error});return ie=t,e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:r.body,children:[e.jsx(xe,{children:"Variant"}),e.jsx(qn,{ProdId:n,Refresh:t})]}),e.jsx(k,{Items:s,Columns:zn})]})}const Xn=E({body:{...L,rowGap:D.spacingVerticalXL,paddingBottom:D.spacingVerticalXXXL}});function Qn({ProdId:n}){const r=Xn(),[s,{setFalse:t,setTrue:a}]=G(),{Nav:o,Paths:c}=re(),l=parseInt(c.at(1));return A.useEffect(()=>{l===n?a():t()},[c]),e.jsxs(e.Fragment,{children:[e.jsx(i,{appearance:"subtle",icon:e.jsx(Me,{}),onClick:()=>{o("Admin",n),a()}}),e.jsxs(Ae,{open:s,position:"end",size:"large",modalType:"alert",children:[e.jsx(De,{children:e.jsx(Ee,{action:e.jsx(i,{appearance:"subtle",icon:e.jsx(Q,{}),onClick:()=>{o("Admin"),t()}}),children:"Product Detail"})}),e.jsxs(Se,{className:r.body,children:[e.jsx(Pn,{ProdId:n}),e.jsx(sn,{ProdId:n}),e.jsx(Tn,{ProdId:n}),e.jsx(_n,{ProdId:n}),e.jsx(hn,{ProdId:n}),e.jsx(fn,{ProdId:n}),e.jsx(pn,{ProdId:n})]})]})]})}const O=new x("Admin","Product","Row");function Wn({item:n}){const[r,s]=A.useState(()=>({Id:n,Cover:"",Name:"Loading..."})),[t,{setTrue:a}]=G(),o=B.Product.Get;return Be(async()=>{const c=await o.Product(n).catch(O.error);if(!c)return O.warn(`Product ${n} Not Found`),a();let l={...r,Name:c.Name,Category:c.Category||"Pending"};s(l);const[u,b]=await o.PhotoList(n,O);b||O.warn(`Product ${n} has no photo`),s(l={...l,Cover:b});const h=await d.Product.Get.Count(n).catch(O.error);h&&s({...l,...h})},[]),t?null:e.jsx(ve,{children:({renderCell:c})=>c(r)},n)}const we=E({two:{flexBasis:"2.5%",flexGrow:0},twoc:{flexBasis:"2.5%",flexGrow:0,justifyContent:"center"}}),$e=new x("Admin","Product"),Yn=[Te(50,$e),m({columnId:"Product",renderHeaderCell:()=>e.jsx(j,{children:"Product"}),renderCell(n){return e.jsx(p,{children:e.jsx(fe,{children:n.Name})})}}),m({columnId:"Category",renderHeaderCell:()=>e.jsx(j,{children:"Category"}),renderCell(n){return e.jsx(p,{children:e.jsx(fe,{children:n.Category})})}}),m({columnId:"Variant",renderHeaderCell:()=>e.jsx(j,{children:"Variant"}),renderCell(n){return e.jsx(p,{children:n.Variant})}}),m({columnId:"Combo",renderHeaderCell:()=>e.jsx(j,{children:"Combo"}),renderCell(n){return e.jsx(p,{children:n.Combo})}}),m({columnId:"Stock",renderHeaderCell:()=>e.jsx(j,{children:"Stock"}),renderCell(n){return e.jsx(p,{children:n.Stock})}}),m({columnId:"Action",renderHeaderCell:()=>e.jsx(j,{className:we().two,children:"Detail"}),renderCell(n){return e.jsx(p,{className:we().twoc,children:e.jsx(Qn,{ProdId:n.Id})})}})];function Jn(){const n=d.Product.Get.useList($e);return e.jsxs(Le,{items:n?n.reverse():[],columns:Yn,children:[e.jsx(Oe,{children:e.jsx(ve,{children:({renderHeaderCell:r})=>r()})}),e.jsx(qe,{children:r=>e.jsx(Wn,{...r})}),!n&&e.jsx(ze,{size:48})]})}const Kn=new x("Admin","User","Delete");function Zn({UserId:n,Refresh:r}){const{dispatch:s,dispatchToast:t}=y(Kn),{run:a}=d.User.Delete.useUser({manual:!0,onError(o,c){s({Message:"Failed Delete User",Request:c,Error:o})},onSuccess(){t(e.jsx(g,{children:e.jsx(f,{children:"User Deleted"})}),{intent:"success"}),r()}});return e.jsx(i,{appearance:"subtle",icon:e.jsx(Y,{}),onClick:()=>a(n)})}const es=new x("Admin","User","Grant");function ns({UserId:n,Admin:r,Refresh:s}){const{dispatch:t,dispatchToast:a}=y(es),{run:o}=d.User.Post.useAdmin({manual:!0,onError(l,u){t({Message:"Failed Grant Admin",Request:u,Error:l})},onSuccess(){a(e.jsx(g,{children:e.jsx(f,{children:"Admin Granted"})}),{intent:"success"}),s()}}),{run:c}=d.User.Delete.useAdmin({manual:!0,onError(l,u){t({Message:"Failed Revoke Admin",Request:u,Error:l})},onSuccess(){a(e.jsx(g,{children:e.jsx(f,{children:"Admin Revoked"})}),{intent:"success"}),s()}});return e.jsx(_e,{checked:r,onChange:(l,u)=>{u.checked?o(n):c(n)}})}const ss=new x("Admin","User"),rs=[m({columnId:"Id",renderHeaderCell:()=>"Id",renderCell(n){return n.Id}}),m({columnId:"Name",renderHeaderCell:()=>"Real Name",renderCell(n){return n.Name}}),m({columnId:"Email",renderHeaderCell:()=>"E-Mail",renderCell(n){return n.EMail}}),m({columnId:"Admin",renderHeaderCell:()=>"Admin",renderCell(n){return e.jsx(ns,{UserId:n.Id,Admin:n.Admin,Refresh:de})}}),m({columnId:"Delete",renderHeaderCell:()=>"Delete",renderCell(n){return e.jsx(Zn,{UserId:n.Id,Refresh:de})}})].map(({renderHeaderCell:n,renderCell:r,...s})=>({...s,renderHeaderCell:()=>e.jsx(j,{children:n()}),renderCell:t=>e.jsx(p,{children:r(t)})}));let de;function ts(){const{data:n,run:r}=T(()=>d.User.Get.List(),{onError:ss.error});return de=r,e.jsx(k,{Items:n,Columns:rs})}const as=new x("Admin");function ds(){const{Paths:n,Nav:r}=re(),s=n.at(1),t=A.useMemo(()=>{switch(s){case"Order":return e.jsx(en,{});case"User":return e.jsx(ts,{});default:return e.jsx(Jn,{})}},[s]),{data:a}=B.User.Get.useMe(as);return a?a.Admin?t:r("/"):e.jsx(Xe,{size:"huge",label:"Authenticating..."})}export{ds as default};
